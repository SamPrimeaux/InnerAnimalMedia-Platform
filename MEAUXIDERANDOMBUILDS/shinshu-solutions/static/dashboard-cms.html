<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Management - Shinshu Solutions</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Mono:wght@400;500;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --orange-primary: #FF8C42;
            --orange-dark: #E67635;
            --orange-light: #FFB67A;
            --cream: #FFF8F0;
            --cream-dark: #F5E6D3;
            --text-dark: #1A1A1A;
            --text-gray: #4A4A4A;
            --white: #FFFFFF;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, var(--cream) 0%, var(--cream-dark) 100%);
            color: var(--text-dark);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Glassmorphic Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            width: 280px;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-right: 1px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
            z-index: 100;
            transition: transform 0.3s ease;
            overflow-y: auto;
        }

        .sidebar.closed {
            transform: translateX(-100%);
        }

        .sidebar-header {
            padding: 2rem 1.5rem;
            border-bottom: 1px solid color-mix(in srgb, var(--orange-primary) 10%, transparent);
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .sidebar-logo svg {
            width: 32px;
            height: 32px;
            stroke: var(--orange-primary);
        }

        .sidebar-logo h1 {
            font-size: 1.25rem;
            color: var(--text-dark);
        }

        .sidebar-tagline {
            font-size: 0.75rem;
            color: var(--text-gray);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .sidebar-nav {
            padding: 1rem 0;
        }

        .nav-section {
            margin-bottom: 1.5rem;
        }

        .nav-section-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-gray);
            padding: 0 1.5rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.5rem;
            color: var(--text-dark);
            text-decoration: none;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: color-mix(in srgb, var(--orange-primary) 10%, transparent);
            border-left-color: var(--orange-primary);
        }

        .nav-item.active {
            background: color-mix(in srgb, var(--orange-primary) 15%, transparent);
            border-left-color: var(--orange-primary);
            color: var(--orange-primary);
            font-weight: 600;
        }

        .nav-item svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
        }

        .nav-item-external {
            margin-top: auto;
            padding-top: 1rem;
            border-top: 1px solid color-mix(in srgb, var(--orange-primary) 10%, transparent);
        }

        /* Hamburger Menu */
        .hamburger {
            position: fixed;
            top: 1.5rem;
            left: 1.5rem;
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            z-index: 101;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .hamburger:hover {
            background: rgba(255, 140, 66, 0.1);
        }

        .hamburger span {
            width: 24px;
            height: 2px;
            background: var(--orange-primary);
            border-radius: 2px;
            transition: all 0.3s;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(7px, 7px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -7px);
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            padding: 2rem;
            transition: margin-left 0.3s ease;
        }

        .main-content.sidebar-closed {
            margin-left: 0;
        }

        /* Top Bar with Breadcrumbs */
        .top-bar {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 50;
        }

        .breadcrumbs {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .breadcrumb-item {
            color: var(--text-gray);
            text-decoration: none;
        }

        .breadcrumb-item:hover {
            color: var(--orange-primary);
        }

        .breadcrumb-separator {
            color: var(--text-gray);
        }

        .breadcrumb-current {
            color: var(--orange-primary);
            font-weight: 600;
        }

        .top-bar-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn-home {
            padding: 0.5rem 1rem;
            background: var(--orange-primary);
            color: var(--white);
            border: none;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-home:hover {
            background: var(--orange-dark);
            transform: translateY(-2px);
        }

        /* Content Cards */
        .content-area {
            display: none;
        }

        .content-area.active {
            display: block;
        }

        .card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 2rem;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 140, 66, 0.1);
        }

        .card h2 {
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            color: var(--text-dark);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid rgba(255, 140, 66, 0.2);
            border-radius: 8px;
            font-family: 'Roboto', sans-serif;
            font-size: 1rem;
            background: white;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--orange-primary);
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--orange-primary) 10%, transparent);
        }

        .form-group textarea {
            min-height: 150px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Roboto', sans-serif;
        }

        .btn-primary {
            background: var(--orange-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--orange-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px color-mix(in srgb, var(--orange-primary) 30%, transparent);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.8);
            color: var(--text-dark);
            border: 2px solid rgba(255, 140, 66, 0.2);
        }

        .btn-secondary:hover {
            background: color-mix(in srgb, var(--orange-primary) 10%, transparent);
            border-color: var(--orange-primary);
        }

        .file-upload {
            border: 2px dashed color-mix(in srgb, var(--orange-primary) 30%, transparent);
            border-radius: 12px;
            padding: 3rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(255, 248, 240, 0.5);
            position: relative;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .file-upload:hover {
            border-color: var(--orange-primary);
            background: rgba(255, 248, 240, 0.8);
        }

        .file-upload.drag-over {
            border-color: var(--orange-primary);
            background: color-mix(in srgb, var(--orange-primary) 10%, transparent);
            transform: scale(1.02);
        }

        .file-upload input {
            display: none;
        }

        .drop-zone-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .file-list {
            width: 100%;
            text-align: left;
        }

        .file-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            background: white;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            border: 1px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);
        }

        .file-item-icon {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            background: color-mix(in srgb, var(--orange-primary) 10%, transparent);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .file-item-info {
            flex: 1;
            min-width: 0;
        }

        .file-item-name {
            font-weight: 600;
            color: var(--text-dark);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-item-size {
            font-size: 0.85rem;
            color: var(--text-gray);
        }

        .file-item-remove {
            background: none;
            border: none;
            color: #dc2626;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .file-item-remove:hover {
            background: color-mix(in srgb, #dc2626 10%, transparent);
        }

        .preview-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .preview-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .preview-image:hover {
            transform: scale(1.05);
        }

        .assets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .asset-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .asset-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px color-mix(in srgb, var(--orange-primary) 20%, transparent);
        }

        .asset-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .asset-card-body {
            padding: 1rem;
        }

        .asset-card h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .asset-card p {
            font-size: 0.85rem;
            color: var(--text-gray);
            margin-bottom: 0.5rem;
        }

        .asset-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        .knowledge-list {
            list-style: none;
        }

        .knowledge-item {
            background: rgba(255, 248, 240, 0.5);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            border-left: 4px solid var(--orange-primary);
        }

        .knowledge-item h3 {
            margin-bottom: 0.5rem;
        }

        .knowledge-item .meta {
            font-size: 0.85rem;
            color: var(--text-gray);
            margin-bottom: 0.5rem;
        }

        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .status-new {
            background: #e3f2fd;
            color: #1565c0;
        }

        .status-responded {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .inquiry-item {
            background: rgba(255, 248, 240, 0.5);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            border-left: 4px solid var(--orange-primary);
        }

        .inquiry-item h3 {
            margin-bottom: 0.5rem;
        }

        .inquiry-item .meta {
            font-size: 0.85rem;
            color: var(--text-gray);
            margin-bottom: 1rem;
        }

        .inquiry-item .message {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            display: flex;
            align-items: center;
            gap: 1.5rem;
            border: 1px solid color-mix(in srgb, var(--orange-primary) 10%, transparent);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .stat-icon svg {
            width: 32px;
            height: 32px;
        }

        .stat-info {
            flex: 1;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--orange-primary);
            line-height: 1;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-gray);
            margin-top: 0.25rem;
        }

        /* Quick Actions */
        .quick-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .quick-action-btn {
            padding: 1.5rem;
            background: color-mix(in srgb, var(--orange-primary) 10%, transparent);
            border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
            font-weight: 500;
            color: var(--text-dark);
        }

        .quick-action-btn:hover {
            background: color-mix(in srgb, var(--orange-primary) 20%, transparent);
            border-color: var(--orange-primary);
            transform: translateY(-2px);
        }

        .quick-action-btn svg {
            width: 32px;
            height: 32px;
            stroke: var(--orange-primary);
        }

        /* Data Tables */
        .data-table-container {
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
        }

        .data-table thead {
            background: color-mix(in srgb, var(--orange-primary) 10%, transparent);
        }

        .data-table th {
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--text-dark);
            border-bottom: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);
        }

        .data-table td {
            padding: 1rem;
            border-bottom: 1px solid color-mix(in srgb, var(--orange-primary) 10%, transparent);
        }

        .data-table tbody tr:hover {
            background: color-mix(in srgb, var(--orange-primary) 5%, transparent);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.open {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1001;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h3 {
            font-size: 1.5rem;
        }

        .modal-close {
            background: transparent;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-gray);
        }

        /* Analytics */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .analytics-card {
            background: color-mix(in srgb, var(--orange-primary) 5%, transparent);
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid var(--orange-primary);
        }

        .analytics-card h3 {
            font-size: 0.9rem;
            color: var(--text-gray);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .analytics-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--orange-primary);
            line-height: 1;
        }

        /* Themes Grid */
        .themes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .theme-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);
            border-radius: 16px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .theme-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px color-mix(in srgb, var(--orange-primary) 20%, transparent);
            border-color: var(--orange-primary);
        }

        .theme-card.active {
            border-color: var(--orange-primary);
            border-width: 3px;
            box-shadow: 0 0 0 4px color-mix(in srgb, var(--orange-primary) 10%, transparent);
        }

        .theme-card.active::before {
            content: 'âœ“';
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            width: 32px;
            height: 32px;
            background: var(--orange-primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .theme-preview-large {
            width: 100%;
            height: 120px;
            border-radius: 12px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .theme-card h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }

        .theme-card p {
            font-size: 0.85rem;
            color: var(--text-gray);
            line-height: 1.5;
        }

        /* Templates Grid */
        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .template-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s;
        }

        .template-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px color-mix(in srgb, var(--orange-primary) 20%, transparent);
        }

        .template-preview {
            width: 100%;
            height: 150px;
            border-radius: 12px;
            margin-bottom: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .template-card h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }

        .template-card p {
            font-size: 0.9rem;
            color: var(--text-gray);
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <!-- Hamburger Menu -->
    <div class="hamburger" onclick="toggleSidebar()">
        <span></span>
        <span></span>
        <span></span>
    </div>

    <!-- Glassmorphic Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 20l9-9 9 9H3z" />
                    <path d="M3 20h18M12 11v9" />
                </svg>
                <h1>Shinshu Solutions</h1>
            </div>
            <p class="sidebar-tagline">Content Management</p>
        </div>

        <nav class="sidebar-nav">
            <div class="nav-section">
                <div class="nav-section-title">Overview</div>
                <a href="#" class="nav-item active" onclick="showContent('overview'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7" />
                        <rect x="14" y="3" width="7" height="7" />
                        <rect x="3" y="14" width="7" height="7" />
                        <rect x="14" y="14" width="7" height="7" />
                    </svg>
                    Dashboard
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Business</div>
                <a href="#" class="nav-item" onclick="showContent('clients'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                        <circle cx="9" cy="7" r="4" />
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                        <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                    </svg>
                    Clients
                </a>
                <a href="#" class="nav-item" onclick="showContent('properties'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                        <polyline points="9 22 9 12 15 12 15 22" />
                    </svg>
                    Properties
                </a>
                <a href="#" class="nav-item" onclick="showContent('projects'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" />
                        <path d="M9 9h6M9 15h6M12 3v18" />
                    </svg>
                    Projects
                </a>
                <a href="#" class="nav-item" onclick="showContent('services'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <line x1="12" y1="2" x2="12" y2="22" />
                        <line x1="2" y1="12" x2="22" y2="12" />
                    </svg>
                    Services
                </a>
                <a href="#" class="nav-item" onclick="showContent('contacts'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" />
                    </svg>
                    Contacts
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Content</div>
                <a href="#" class="nav-item" onclick="showContent('content-editor'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                        <polyline points="14 2 14 8 20 8" />
                        <line x1="16" y1="13" x2="8" y2="13" />
                        <line x1="16" y1="17" x2="8" y2="17" />
                        <polyline points="10 9 9 9 8 9" />
                    </svg>
                    Content Editor
                </a>
                <a href="#" class="nav-item" onclick="showContent('assets'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" />
                        <circle cx="9" cy="9" r="2" />
                        <path d="M21 15l-3.086-3.086a2 2 0 0 0-2.828 0L6 21" />
                    </svg>
                    Assets & SEO
                </a>
                <a href="#" class="nav-item" onclick="showContent('knowledge'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" />
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" />
                    </svg>
                    Knowledge Base
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Communication</div>
                <a href="#" class="nav-item" onclick="showContent('inquiries'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                    </svg>
                    Inquiries
                </a>
                <a href="#" class="nav-item" onclick="showContent('email-templates'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                        <polyline points="22,6 12,13 2,6" />
                    </svg>
                    Email Templates
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Analytics</div>
                <a href="#" class="nav-item" onclick="showContent('analytics'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="20" x2="18" y2="10" />
                        <line x1="12" y1="20" x2="12" y2="4" />
                        <line x1="6" y1="20" x2="6" y2="14" />
                    </svg>
                    Analytics
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Settings</div>
                <a href="#" class="nav-item" onclick="showContent('setup'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                    Setup & Integrations
                </a>
                <a href="#" class="nav-item" onclick="showContent('customer-service'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                        <path d="M8 10h.01M12 10h.01M16 10h.01" />
                    </svg>
                    Customer Service
                </a>
                <a href="#" class="nav-item" onclick="showContent('settings'); return false;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3" />
                        <path
                            d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24" />
                    </svg>
                    Settings
                </a>
            </div>

            <div class="nav-section">
                <a href="/" class="nav-item nav-item-external">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                        <polyline points="9 22 9 12 15 12 15 22" />
                    </svg>
                    Back to Website
                </a>
            </div>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Top Bar with Breadcrumbs -->
        <div class="top-bar">
            <div class="breadcrumbs" id="breadcrumbs">
                <a href="/" class="breadcrumb-item">Home</a>
                <span class="breadcrumb-separator">/</span>
                <span class="breadcrumb-current">Dashboard</span>
            </div>
            <div class="top-bar-actions">
                <a href="/" class="btn-home">Visit Website</a>
            </div>
        </div>

        <!-- Overview/Dashboard Home -->
        <div id="overview-content" class="content-area active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon"
                        style="background: color-mix(in srgb, var(--orange-primary) 20%, transparent);">
                        <svg viewBox="0 0 24 24" fill="none" stroke="var(--orange-primary)" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                            <circle cx="9" cy="7" r="4" />
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                            <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                        </svg>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="stat-clients">0</div>
                        <div class="stat-label">Total Clients</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon"
                        style="background: color-mix(in srgb, var(--orange-primary) 20%, transparent);">
                        <svg viewBox="0 0 24 24" fill="none" stroke="var(--orange-primary)" stroke-width="2">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                            <polyline points="9 22 9 12 15 12 15 22" />
                        </svg>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="stat-properties">0</div>
                        <div class="stat-label">Properties</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon"
                        style="background: color-mix(in srgb, var(--orange-primary) 20%, transparent);">
                        <svg viewBox="0 0 24 24" fill="none" stroke="var(--orange-primary)" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" />
                            <path d="M9 9h6M9 15h6M12 3v18" />
                        </svg>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="stat-projects">0</div>
                        <div class="stat-label">Active Projects</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon"
                        style="background: color-mix(in srgb, var(--orange-primary) 20%, transparent);">
                        <svg viewBox="0 0 24 24" fill="none" stroke="var(--orange-primary)" stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                        </svg>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="stat-inquiries">0</div>
                        <div class="stat-label">New Inquiries</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Quick Actions</h2>
                <div class="quick-actions-grid">
                    <button class="quick-action-btn" onclick="showContent('clients'); addNewClient();">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19" />
                            <line x1="5" y1="12" x2="19" y2="12" />
                        </svg>
                        Add Client
                    </button>
                    <button class="quick-action-btn" onclick="showContent('properties'); addNewProperty();">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19" />
                            <line x1="5" y1="12" x2="19" y2="12" />
                        </svg>
                        Add Property
                    </button>
                    <button class="quick-action-btn" onclick="showContent('projects'); addNewProject();">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19" />
                            <line x1="5" y1="12" x2="19" y2="12" />
                        </svg>
                        New Project
                    </button>
                    <button class="quick-action-btn" onclick="exportData()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                            <polyline points="7 10 12 15 17 10" />
                            <line x1="12" y1="15" x2="12" y2="3" />
                        </svg>
                        Export Data
                    </button>
                    <button class="quick-action-btn" onclick="sendProjectSummaryEmail()"
                        style="background: linear-gradient(135deg, #4A9FFF, #1E5FA8); color: white;">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                            <polyline points="22,6 12,13 2,6" />
                        </svg>
                        Send Project Summary
                    </button>
                </div>
            </div>

            <div class="card">
                <h2>Recent Activity</h2>
                <div id="recent-activity">
                    <p>Loading...</p>
                </div>
            </div>
        </div>

        <!-- Clients Management -->
        <div id="clients-content" class="content-area">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2>Clients</h2>
                    <button class="btn btn-primary" onclick="openClientModal()">+ Add Client</button>
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <input type="text" id="client-search" placeholder="Search clients..."
                        style="width: 100%; padding: 0.75rem; border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent); border-radius: 8px;"
                        onkeyup="filterClients()">
                </div>

                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Country</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="clients-table-body">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 2rem;">Loading clients...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Properties Management -->
        <div id="properties-content" class="content-area">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2>Properties</h2>
                    <button class="btn btn-primary" onclick="openPropertyModal()">+ Add Property</button>
                </div>

                <div style="margin-bottom: 1.5rem; display: flex; gap: 1rem;">
                    <select id="property-filter-client"
                        style="flex: 1; padding: 0.75rem; border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent); border-radius: 8px;"
                        onchange="filterProperties()">
                        <option value="">All Clients</option>
                    </select>
                    <input type="text" id="property-search" placeholder="Search properties..."
                        style="flex: 2; padding: 0.75rem; border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent); border-radius: 8px;"
                        onkeyup="filterProperties()">
                </div>

                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Address</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Value</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="properties-table-body">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 2rem;">Loading properties...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Projects Management -->
        <div id="projects-content" class="content-area">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2>Projects</h2>
                    <button class="btn btn-primary" onclick="openProjectModal()">+ New Project</button>
                </div>

                <div style="margin-bottom: 1.5rem; display: flex; gap: 1rem;">
                    <select id="project-filter-status"
                        style="flex: 1; padding: 0.75rem; border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent); border-radius: 8px;"
                        onchange="filterProjects()">
                        <option value="">All Status</option>
                        <option value="planning">Planning</option>
                        <option value="in_progress">In Progress</option>
                        <option value="on_hold">On Hold</option>
                        <option value="completed">Completed</option>
                    </select>
                    <input type="text" id="project-search" placeholder="Search projects..."
                        style="flex: 2; padding: 0.75rem; border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent); border-radius: 8px;"
                        onkeyup="filterProjects()">
                </div>

                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Budget</th>
                                <th>Priority</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="projects-table-body">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 2rem;">Loading projects...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Services Management -->
        <div id="services-content" class="content-area">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2>Services</h2>
                    <button class="btn btn-primary" onclick="openServiceModal()">+ Add Service</button>
                </div>

                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Project</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Total Price</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="services-table-body">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 2rem;">Loading services...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Contacts Management -->
        <div id="contacts-content" class="content-area">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2>Contacts</h2>
                    <button class="btn btn-primary" onclick="openContactModal()">+ Add Contact</button>
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <select id="contact-filter-client"
                        style="width: 100%; padding: 0.75rem; border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent); border-radius: 8px;"
                        onchange="filterContacts()">
                        <option value="">All Clients</option>
                    </select>
                </div>

                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Title</th>
                                <th>Role</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="contacts-table-body">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 2rem;">Loading contacts...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings-content" class="content-area">
            <div class="card">
                <h2>Theme Selection</h2>
                <p style="margin-bottom: 2rem; color: var(--text-gray);">Choose a theme to customize the look and feel
                    of your dashboard and website.</p>

                <div class="themes-grid" id="themes-grid">
                    <!-- Themes will be loaded here -->
                </div>
            </div>

            <div class="card">
                <h2>Template Selection</h2>
                <p style="margin-bottom: 2rem; color: var(--text-gray);">Select a template preset for quick
                    customization.</p>

                <div class="templates-grid">
                    <div class="template-card">
                        <div class="template-preview"
                            style="background: linear-gradient(135deg, #FF8C42 0%, #E67635 100%);"></div>
                        <h3>Business Professional</h3>
                        <p>Clean, corporate layout perfect for client presentations</p>
                        <button class="btn btn-secondary btn-small">Apply Template</button>
                    </div>

                    <div class="template-card">
                        <div class="template-preview"
                            style="background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%);"></div>
                        <h3>Modern Minimal</h3>
                        <p>Minimalist design with focus on content</p>
                        <button class="btn btn-secondary btn-small">Apply Template</button>
                    </div>

                    <div class="template-card">
                        <div class="template-preview"
                            style="background: linear-gradient(135deg, #1E293B 0%, #0F172A 100%);"></div>
                        <h3>Dark Professional</h3>
                        <p>Dark theme optimized for extended use</p>
                        <button class="btn btn-secondary btn-small">Apply Template</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Setup & Integrations -->
        <div id="setup-content" class="content-area">
            <div class="card">
                <h2>ðŸš€ Platform Setup & Integrations</h2>
                <p style="margin-bottom: 2rem; color: var(--text-gray);">Follow these step-by-step guides to set up
                    professional email, SEO tracking, and global customer service capabilities.</p>

                <!-- Resend Email Setup -->
                <div class="setup-card"
                    style="margin-bottom: 2rem; padding: 2rem; background: white; border-radius: 12px; border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);">
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
                        <div
                            style="width: 48px; height: 48px; background: linear-gradient(135deg, var(--orange-primary), var(--orange-dark)); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem; font-weight: bold;">
                            1</div>
                        <div>
                            <h3 style="margin: 0; font-size: 1.3rem;">Resend Email Integration</h3>
                            <p style="margin: 0.25rem 0 0 0; color: var(--text-gray); font-size: 0.9rem;">Professional
                                transactional emails for customer inquiries</p>
                        </div>
                    </div>

                    <div id="resend-status"
                        style="padding: 1rem; background: #e8f5e9; border-radius: 8px; margin-bottom: 1.5rem; border-left: 4px solid #4caf50;">
                        <p style="margin: 0; font-weight: 600; color: #2e7d32;">âœ… API Key Added to Cloudflare!</p>
                        <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; color: var(--text-gray);">
                            Your Resend API key has been configured. Click below to test the connection.
                        </p>
                        <button class="btn btn-primary" onclick="testResendConnection()" style="margin-top: 1rem;">
                            ðŸ§ª Test Resend Connection
                        </button>
                    </div>

                    <div class="setup-steps">
                        <div class="setup-step">
                            <h4>Step 1: Create Resend Account</h4>
                            <ol style="margin-left: 1.5rem; line-height: 2;">
                                <li>Visit <a href="https://resend.com" target="_blank"
                                        style="color: var(--orange-primary); font-weight: 600;">resend.com</a> and sign
                                    up for a free account</li>
                                <li>Verify your email address</li>
                                <li>Complete account setup (takes ~2 minutes)</li>
                            </ol>
                        </div>

                        <div class="setup-step">
                            <h4>Step 2: Get Your API Key</h4>
                            <ol style="margin-left: 1.5rem; line-height: 2;">
                                <li>Go to <strong>API Keys</strong> in your Resend dashboard</li>
                                <li>Click <strong>"Create API Key"</strong></li>
                                <li>Name it: <code
                                        style="background: #f5f5f5; padding: 0.25rem 0.5rem; border-radius: 4px;">Shinshu Solutions Production</code>
                                </li>
                                <li>Copy the API key (starts with <code
                                        style="background: #f5f5f5; padding: 0.25rem 0.5rem; border-radius: 4px;">re_</code>)
                                </li>
                            </ol>
                        </div>

                        <div class="setup-step">
                            <h4>Step 3: Add Domain (Optional but Recommended)</h4>
                            <ol style="margin-left: 1.5rem; line-height: 2;">
                                <li>In Resend dashboard, go to <strong>Domains</strong></li>
                                <li>Click <strong>"Add Domain"</strong></li>
                                <li>Enter your domain: <code
                                        style="background: #f5f5f5; padding: 0.25rem 0.5rem; border-radius: 4px;">shinshu-solutions.meauxbility.workers.dev</code>
                                    (or your custom domain)</li>
                                <li>Add the DNS records Resend provides to your domain</li>
                                <li>Wait for verification (usually 5-10 minutes)</li>
                            </ol>
                        </div>

                        <div class="setup-step">
                            <h4>Step 4: Configure in Cloudflare âœ… DONE</h4>
                            <div style="padding: 1rem; background: #e8f5e9; border-radius: 8px; margin: 1rem 0;">
                                <p style="margin: 0; color: #2e7d32; font-weight: 600;">âœ… API Key Successfully Added!
                                </p>
                                <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; color: var(--text-gray);">
                                    The Resend API key has been added to your Cloudflare Worker. You can now test the
                                    connection using the button above.
                                </p>
                            </div>
                            <p style="margin-top: 1rem; font-size: 0.9rem; color: var(--text-gray);">
                                <strong>Note:</strong> If you need to add RESEND_FROM_EMAIL or RESEND_ADMIN_EMAIL, you
                                can do so via:
                            </p>
                            <ol style="margin-left: 1.5rem; line-height: 2; margin-top: 0.5rem;">
                                <li>Cloudflare Dashboard â†’ Workers â†’ shinshu-solutions â†’ Settings â†’ Variables</li>
                                <li>Or use: <code
                                        style="background: #f5f5f5; padding: 0.25rem 0.5rem; border-radius: 4px;">wrangler secret put RESEND_FROM_EMAIL</code>
                                </li>
                            </ol>
                            <div
                                style="margin: 1rem 0; padding: 1rem; background: #f8f9fa; border-radius: 8px; font-family: 'Roboto Mono', monospace; font-size: 0.85rem;">
                                <div style="margin-bottom: 0.5rem;">
                                    <strong>RESEND_API_KEY</strong> =
                                    <code
                                        style="background: #e8f5e9; padding: 0.25rem 0.5rem; border-radius: 4px; color: #2e7d32; font-weight: 600; font-size: 0.8rem;">
                                        re_BhGPu5Kt_7MYSXE9GhupsWJZc2iEfbZsu
                                    </code>
                                    <span style="color: #4caf50; margin-left: 0.5rem; font-size: 0.75rem;">âœ…
                                        Added</span>
                                </div>
                                <div style="margin-bottom: 0.5rem;">
                                    <strong>RESEND_FROM_EMAIL</strong> =
                                    <code
                                        style="background: #e8f5e9; padding: 0.25rem 0.5rem; border-radius: 4px; color: #2e7d32; font-weight: 600; font-size: 0.8rem;">
                                        [email protected]
                                    </code>
                                    <span style="color: #ff9800; margin-left: 0.5rem; font-size: 0.75rem;">âš ï¸ Verify
                                        exact email in Resend</span>
                                </div>
                                <div
                                    style="margin-top: 0.5rem; padding: 0.75rem; background: #fff3e0; border-radius: 6px; border-left: 3px solid #ff9800; font-size: 0.85rem; color: #e65100;">
                                    <strong>âš ï¸ Important:</strong> Make sure the email address above matches exactly
                                    what's verified in your Resend dashboard.
                                    Check Resend â†’ Domains â†’ inneranimalmedia.com to see verified email addresses.
                                </div>
                                <div>
                                    <strong>RESEND_ADMIN_EMAIL</strong> =
                                    <code
                                        style="background: #e8f5e9; padding: 0.25rem 0.5rem; border-radius: 4px; color: #2e7d32; font-weight: 600; font-size: 0.8rem;">
                                        inneranimalclothing@gmail.com
                                    </code>
                                    <span style="color: #4caf50; margin-left: 0.5rem; font-size: 0.75rem;">âœ…
                                        Added</span>
                                </div>
                            </div>
                            <p style="font-size: 0.85rem; color: var(--text-gray); margin-top: 0.5rem;">ðŸ’¡
                                <strong>Tip:</strong> Use your verified domain email for better deliverability
                            </p>
                        </div>

                        <div class="setup-step">
                            <h4>Step 5: Set Up Webhook (Optional but Recommended)</h4>
                            <p style="margin-bottom: 0.5rem; font-size: 0.9rem; color: var(--text-gray);">
                                Webhooks track email events (delivered, opened, clicked, bounced) for better analytics.
                            </p>
                            <ol style="margin-left: 1.5rem; line-height: 2;">
                                <li>In Resend dashboard, go to <strong>Webhooks</strong></li>
                                <li>Click <strong>"Add Webhook"</strong></li>
                                <li>Enter webhook URL:
                                    <code
                                        style="background: #f5f5f5; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem; display: block; margin: 0.5rem 0;">
                                        https://shinshu-solutions.meauxbility.workers.dev/api/webhooks/resend
                                    </code>
                                </li>
                                <li>Select events to track:
                                    <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                                        <li>âœ… email.sent</li>
                                        <li>âœ… email.delivered</li>
                                        <li>âœ… email.opened</li>
                                        <li>âœ… email.clicked</li>
                                        <li>âœ… email.bounced</li>
                                        <li>âœ… email.complained</li>
                                    </ul>
                                </li>
                                <li>Click <strong>"Save"</strong></li>
                            </ol>
                            <div
                                style="margin-top: 1rem; padding: 1rem; background: #e3f2fd; border-radius: 8px; border-left: 4px solid #2196f3;">
                                <p style="margin: 0; font-weight: 600; color: #1565c0; font-size: 0.9rem;">ðŸ“Š Webhook
                                    Benefits:</p>
                                <ul style="margin: 0.5rem 0 0 1.5rem; color: var(--text-gray); font-size: 0.85rem;">
                                    <li>Track email delivery status</li>
                                    <li>Monitor open rates and click-through rates</li>
                                    <li>Get notified of bounces or spam complaints</li>
                                    <li>Better email analytics in your dashboard</li>
                                </ul>
                            </div>
                        </div>

                        <div class="setup-step">
                            <h4>Step 6: Test Email</h4>
                            <ol style="margin-left: 1.5rem; line-height: 2;">
                                <li>Click <strong>"Test Resend Connection"</strong> button above</li>
                                <li>Check your email inbox (inneranimalclothing@gmail.com)</li>
                                <li>Submit a test inquiry on your website contact form</li>
                                <li>Verify auto-response email is sent</li>
                                <li>Check Resend dashboard under <strong>Logs</strong> for delivery status</li>
                            </ol>
                        </div>
                    </div>

                    <div style="margin-top: 2rem; padding: 1rem; background: #e8f5e9; border-radius: 8px;">
                        <p style="margin: 0; font-weight: 600; color: #2e7d32;">âœ… Benefits:</p>
                        <ul style="margin: 0.5rem 0 0 1.5rem; color: var(--text-gray);">
                            <li>Professional auto-responses to customer inquiries</li>
                            <li>Email notifications when new inquiries arrive</li>
                            <li>Multi-language email templates (English, Japanese, Chinese, Korean)</li>
                            <li>High deliverability rates</li>
                            <li>Free tier: 3,000 emails/month</li>
                        </ul>
                    </div>
                </div>

                <!-- Google Search Console Setup -->
                <div class="setup-card"
                    style="margin-bottom: 2rem; padding: 2rem; background: white; border-radius: 12px; border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);">
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
                        <div
                            style="width: 48px; height: 48px; background: linear-gradient(135deg, var(--orange-primary), var(--orange-dark)); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem; font-weight: bold;">
                            2</div>
                        <div>
                            <h3 style="margin: 0; font-size: 1.3rem;">Google Search Console</h3>
                            <p style="margin: 0.25rem 0 0 0; color: var(--text-gray); font-size: 0.9rem;">Track SEO
                                performance and search visibility</p>
                        </div>
                    </div>

                    <div class="setup-steps">
                        <div class="setup-step">
                            <h4>Step 1: Access Google Search Console</h4>
                            <ol style="margin-left: 1.5rem; line-height: 2;">
                                <li>Visit <a href="https://search.google.com/search-console" target="_blank"
                                        style="color: var(--orange-primary); font-weight: 600;">search.google.com/search-console</a>
                                </li>
                                <li>Sign in with your Google account</li>
                                <li>Click <strong>"Add Property"</strong></li>
                            </ol>
                        </div>

                        <div class="setup-step">
                            <h4>Step 2: Add Your Website</h4>
                            <ol style="margin-left: 1.5rem; line-height: 2;">
                                <li>Choose <strong>"URL prefix"</strong> method</li>
                                <li>Enter your website URL: <code
                                        style="background: #f5f5f5; padding: 0.25rem 0.5rem; border-radius: 4px;">https://shinshu-solutions.meauxbility.workers.dev</code>
                                </li>
                                <li>Click <strong>"Continue"</strong></li>
                            </ol>
                        </div>

                        <div class="setup-step">
                            <h4>Step 3: Verify Ownership</h4>
                            <p style="margin-bottom: 0.5rem;"><strong>Option A: HTML Tag (Easiest)</strong></p>
                            <ol style="margin-left: 1.5rem; line-height: 2; margin-bottom: 1.5rem;">
                                <li>Google will provide an HTML meta tag</li>
                                <li>Copy the <code
                                        style="background: #f5f5f5; padding: 0.25rem 0.5rem; border-radius: 4px;">content</code>
                                    value</li>
                                <li>In this dashboard, go to <strong>Content Editor â†’ Home Page</strong></li>
                                <li>Add this to the &lt;head&gt; section: <code
                                        style="background: #f5f5f5; padding: 0.25rem 0.5rem; border-radius: 4px;">&lt;meta name="google-site-verification" content="YOUR_CODE"&gt;</code>
                                </li>
                                <li>Save and click <strong>"Verify"</strong> in Google Search Console</li>
                            </ol>
                            <p style="margin-bottom: 0.5rem;"><strong>Option B: DNS Record</strong></p>
                            <ol style="margin-left: 1.5rem; line-height: 2;">
                                <li>If you have a custom domain, add the TXT record Google provides</li>
                                <li>Wait for DNS propagation (5-30 minutes)</li>
                                <li>Click <strong>"Verify"</strong></li>
                            </ol>
                        </div>

                        <div class="setup-step">
                            <h4>Step 4: Submit Sitemap</h4>
                            <ol style="margin-left: 1.5rem; line-height: 2;">
                                <li>Once verified, go to <strong>Sitemaps</strong> in the left menu</li>
                                <li>Enter: <code
                                        style="background: #f5f5f5; padding: 0.25rem 0.5rem; border-radius: 4px;">sitemap.xml</code>
                                </li>
                                <li>Click <strong>"Submit"</strong></li>
                                <li>Google will start indexing your pages (takes 1-7 days)</li>
                            </ol>
                        </div>

                        <div class="setup-step">
                            <h4>Step 5: Monitor Performance</h4>
                            <ol style="margin-left: 1.5rem; line-height: 2;">
                                <li>Check <strong>Performance</strong> tab for search queries and clicks</li>
                                <li>Review <strong>Coverage</strong> to see indexed pages</li>
                                <li>Use <strong>Enhancements</strong> for mobile usability and Core Web Vitals</li>
                            </ol>
                        </div>
                    </div>

                    <div style="margin-top: 2rem; padding: 1rem; background: #e3f2fd; border-radius: 8px;">
                        <p style="margin: 0; font-weight: 600; color: #1565c0;">ðŸ“Š Benefits:</p>
                        <ul style="margin: 0.5rem 0 0 1.5rem; color: var(--text-gray);">
                            <li>Track which keywords bring visitors</li>
                            <li>Monitor search rankings</li>
                            <li>Identify and fix indexing issues</li>
                            <li>See click-through rates from search</li>
                            <li>Free forever - no cost</li>
                        </ul>
                    </div>
                </div>

                <!-- Additional Integrations -->
                <div class="setup-card"
                    style="padding: 2rem; background: white; border-radius: 12px; border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);">
                    <h3 style="margin-bottom: 1rem;">ðŸ”Œ Additional Integrations (Coming Soon)</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                        <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                            <h4 style="margin: 0 0 0.5rem 0; font-size: 1rem;">Google Analytics</h4>
                            <p style="margin: 0; font-size: 0.85rem; color: var(--text-gray);">Track website visitors
                                and behavior</p>
                        </div>
                        <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                            <h4 style="margin: 0 0 0.5rem 0; font-size: 1rem;">Stripe/Payment</h4>
                            <p style="margin: 0; font-size: 0.85rem; color: var(--text-gray);">Accept payments for
                                services</p>
                        </div>
                        <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                            <h4 style="margin: 0 0 0.5rem 0; font-size: 1rem;">Calendar Integration</h4>
                            <p style="margin: 0; font-size: 0.85rem; color: var(--text-gray);">Sync with Google Calendar
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Customer Service -->
        <div id="customer-service-content" class="content-area">
            <div class="card">
                <h2>ðŸŒ Bilingual Customer Service</h2>
                <div
                    style="margin-bottom: 2rem; padding: 1rem; background: #e8f5e9; border-radius: 8px; border-left: 4px solid #4caf50;">
                    <p style="margin: 0; color: #2e7d32; font-weight: 600;">âœ… Global Support Active</p>
                    <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; color: var(--text-gray);">Manage customer
                        inquiries in English, Japanese, Chinese, and Korean. All inquiries are automatically detected by
                        language and routed appropriately.</p>
                </div>

                <div style="margin-bottom: 2rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="filterInquiriesByStatus('new')">New Inquiries</button>
                    <button class="btn btn-secondary" onclick="filterInquiriesByStatus('responded')">Responded</button>
                    <button class="btn btn-secondary" onclick="filterInquiriesByStatus('resolved')">Resolved</button>
                    <button class="btn btn-secondary" onclick="filterInquiriesByStatus('all')">All</button>
                    <select id="inquiry-language-filter"
                        style="padding: 0.5rem; border-radius: 8px; border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);"
                        onchange="filterInquiriesByLanguage()">
                        <option value="">All Languages</option>
                        <option value="en">English</option>
                        <option value="ja">Japanese (æ—¥æœ¬èªž)</option>
                        <option value="zh">Chinese (ä¸­æ–‡)</option>
                        <option value="ko">Korean (í•œêµ­ì–´)</option>
                    </select>
                </div>

                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Language</th>
                                <th>Subject</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="customer-service-table-body">
                            <tr>
                                <td colspan="7" style="text-align: center; padding: 2rem;">Loading inquiries...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <h2>ðŸ“Š Service Statistics</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem;">
                    <div
                        style="padding: 1.5rem; background: linear-gradient(135deg, var(--orange-light), var(--orange-primary)); border-radius: 12px; color: white;">
                        <div style="font-size: 2rem; font-weight: bold;" id="cs-total-inquiries">0</div>
                        <div style="font-size: 0.9rem; opacity: 0.9;">Total Inquiries</div>
                    </div>
                    <div
                        style="padding: 1.5rem; background: linear-gradient(135deg, #4caf50, #2e7d32); border-radius: 12px; color: white;">
                        <div style="font-size: 2rem; font-weight: bold;" id="cs-avg-response-time">-</div>
                        <div style="font-size: 0.9rem; opacity: 0.9;">Avg Response Time</div>
                    </div>
                    <div
                        style="padding: 1.5rem; background: linear-gradient(135deg, #2196f3, #1565c0); border-radius: 12px; color: white;">
                        <div style="font-size: 2rem; font-weight: bold;" id="cs-languages">4</div>
                        <div style="font-size: 0.9rem; opacity: 0.9;">Languages Supported</div>
                    </div>
                    <div
                        style="padding: 1.5rem; background: linear-gradient(135deg, #ff9800, #f57c00); border-radius: 12px; color: white;">
                        <div style="font-size: 2rem; font-weight: bold;" id="cs-satisfaction">-</div>
                        <div style="font-size: 0.9rem; opacity: 0.9;">Satisfaction Rate</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics -->
        <div id="analytics-content" class="content-area">
            <div class="card">
                <h2>Business Analytics</h2>
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <h3>Revenue Overview</h3>
                        <div class="analytics-value" id="analytics-revenue">Â¥0</div>
                        <p style="color: var(--text-gray); font-size: 0.9rem;">Total project value</p>
                    </div>
                    <div class="analytics-card">
                        <h3>Active Projects</h3>
                        <div class="analytics-value" id="analytics-active-projects">0</div>
                        <p style="color: var(--text-gray); font-size: 0.9rem;">Currently in progress</p>
                    </div>
                    <div class="analytics-card">
                        <h3>Client Growth</h3>
                        <div class="analytics-value" id="analytics-client-growth">0%</div>
                        <p style="color: var(--text-gray); font-size: 0.9rem;">This month</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Project Status Breakdown</h2>
                <div id="project-status-chart" style="min-height: 300px; padding: 2rem;">
                    <p>Loading chart data...</p>
                </div>
            </div>
        </div>

        <!-- Content Editor -->
        <div id="content-editor-content" class="content-area">
            <div class="card">
                <h2>Site Content Management</h2>
                <div
                    style="margin-bottom: 2rem; padding: 1rem; background: #e8f5e9; border-radius: 8px; border-left: 4px solid #4caf50;">
                    <p style="margin: 0; color: #2e7d32; font-weight: 600;">âœ… Real-time Sync Active</p>
                    <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; color: var(--text-gray);">Changes to content,
                        assets, and SEO metadata sync immediately to your live site. No deployment needed.</p>
                </div>

                <div style="margin-bottom: 2rem;">
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Select Page/Section</label>
                    <select id="content-selector"
                        style="width: 100%; padding: 0.75rem; border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent); border-radius: 8px;"
                        onchange="loadContent()">
                        <option value="">-- Select Content to Edit --</option>
                        <optgroup label="Pages">
                            <option value="page:/">Home Page</option>
                            <option value="page:/about">About Page</option>
                            <option value="page:/services">Services Page</option>
                            <option value="page:/contact">Contact Page</option>
                            <option value="page:/gallery">Gallery Page</option>
                            <option value="page:/adventures">Adventures Page</option>
                        </optgroup>
                        <optgroup label="Sections">
                            <option value="section:hero">Hero Section</option>
                            <option value="section:services">Services Section</option>
                            <option value="section:about">About Section</option>
                            <option value="section:testimonials">Testimonials</option>
                            <option value="section:portfolio">Portfolio Section</option>
                        </optgroup>
                        <optgroup label="Adventures">
                            <option value="adventure:new">New Adventure Story</option>
                        </optgroup>
                        <optgroup label="Components">
                            <option value="component:business-card">Business Card</option>
                            <option value="component:footer">Footer</option>
                        </optgroup>
                    </select>
                </div>

                <div id="content-editor-form" style="display: none;">
                    <div class="form-group">
                        <label>Title</label>
                        <input type="text" id="content-title" class="form-control">
                    </div>

                    <div class="form-group">
                        <label>Content (HTML/Markdown)</label>
                        <textarea id="content-body" rows="15" class="form-control"
                            style="font-family: 'Roboto Mono', monospace; font-size: 0.9rem;"
                            placeholder="For adventure stories, include: location, elevation, difficulty, date, and a detailed description of the hike experience..."></textarea>
                        <div style="margin-top: 0.5rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                            <button type="button" class="btn btn-secondary btn-small"
                                onclick="previewContent()">Preview</button>
                            <button type="button" class="btn btn-secondary btn-small"
                                onclick="insertImageFromAssets()">Insert Image from Assets</button>
                            <button type="button" class="btn btn-secondary btn-small" onclick="insertImage()">Insert
                                Image URL</button>
                            <button type="button" class="btn btn-secondary btn-small" onclick="insertLink()">Insert
                                Link</button>
                            <button type="button" class="btn btn-secondary btn-small"
                                onclick="insertAdventureTemplate()">Adventure Template</button>
                        </div>
                        <p style="margin-top: 0.5rem; font-size: 0.85rem; color: var(--text-gray);">
                            ðŸ’¡ <strong>Tip:</strong> Use "Insert Image from Assets" to select images you've uploaded to
                            R2. For adventure content, use the template button to get started with the proper structure.
                        </p>
                    </div>

                    <div class="form-group"
                        style="margin-top: 2rem; padding-top: 2rem; border-top: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);">
                        <h3 style="margin-bottom: 1rem; font-size: 1.1rem;">SEO Metadata</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Meta Description</label>
                                <textarea id="content-meta-description" rows="2" class="form-control"
                                    placeholder="Brief description for search engines (150-160 characters)"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Meta Keywords</label>
                                <input type="text" id="content-meta-keywords" class="form-control"
                                    placeholder="keyword1, keyword2, keyword3">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>OG Title (Open Graph)</label>
                                <input type="text" id="content-og-title" class="form-control"
                                    placeholder="Title for social media sharing">
                            </div>
                            <div class="form-group">
                                <label>OG Description</label>
                                <input type="text" id="content-og-description" class="form-control"
                                    placeholder="Description for social media sharing">
                            </div>
                        </div>
                    </div>

                    <div id="content-preview"
                        style="display: none; margin-top: 1rem; padding: 1.5rem; background: #FFF8F0; border-radius: 8px; border: 2px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Language</label>
                            <select id="content-language" class="form-control">
                                <option value="en">English</option>
                                <option value="ja">Japanese</option>
                                <option value="zh">Chinese</option>
                                <option value="ko">Korean</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Order/Position</label>
                            <input type="number" id="content-order" class="form-control" value="0">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="content-published" checked> Published (visible on site)
                        </label>
                    </div>

                    <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                        <button type="button" class="btn btn-primary" onclick="saveContent()">Save Content</button>
                        <button type="button" class="btn btn-secondary" onclick="cancelContentEdit()">Cancel</button>
                        <button type="button" class="btn btn-secondary" onclick="viewContentHistory()">View
                            History</button>
                    </div>
                </div>

                <div id="content-list" class="card" style="margin-top: 2rem;">
                    <h3>All Content</h3>
                    <div id="content-items-list" style="margin-top: 1rem;">
                        <p>Select a page/section above or browse all content below.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Assets & SEO Content -->
        <div id="assets-content" class="content-area">
            <div class="card">
                <h2>Upload New Asset</h2>
                <form id="asset-upload-form" onsubmit="uploadAsset(event)">
                    <div class="form-group">
                        <label>File</label>
                        <div class="file-upload" id="drop-zone" onclick="document.getElementById('asset-file').click()">
                            <input type="file" id="asset-file" onchange="handleFileSelect(event)" multiple
                                accept="image/*,video/*,.pdf,.doc,.docx">
                            <div class="drop-zone-content">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                    style="width: 48px; height: 48px; margin-bottom: 1rem; stroke: var(--orange-primary);">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                                    <polyline points="17 8 12 3 7 8" />
                                    <line x1="12" y1="3" x2="12" y2="15" />
                                </svg>
                                <p style="font-weight: 600; margin-bottom: 0.5rem;">Drag & Drop Files Here</p>
                                <p style="font-size: 0.9rem; color: var(--text-gray);">or click to browse</p>
                                <p style="font-size: 0.85rem; color: var(--text-gray); margin-top: 0.5rem;">Images,
                                    Videos, Documents (Multiple files supported)</p>
                            </div>
                            <div id="file-list" class="file-list"
                                style="display: none; margin-top: 1rem; padding-top: 1rem; border-top: 2px dashed color-mix(in srgb, var(--orange-primary) 30%, transparent);">
                            </div>
                        </div>
                        <div id="preview-container" class="preview-container"></div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Title</label>
                            <input type="text" id="asset-title" required>
                        </div>
                        <div class="form-group">
                            <label>Asset Type</label>
                            <select id="asset-type" required>
                                <option value="image">Image</option>
                                <option value="video">Video</option>
                                <option value="document">Document</option>
                                <option value="page">Page</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Category <span style="color: var(--text-gray); font-size: 0.85rem;">(for
                                    organization)</span></label>
                            <select id="asset-category">
                                <option value="">None</option>
                                <option value="profile">Profile Image</option>
                                <option value="hero">Hero Background</option>
                                <option value="portfolio">Portfolio/Gallery</option>
                                <option value="hiking">Hiking Adventures</option>
                                <option value="summit">Summit Photos</option>
                                <option value="landscape">Landscapes</option>
                                <option value="nagano">Nagano Region</option>
                                <option value="service">Service Images</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Location <span style="color: var(--text-gray); font-size: 0.85rem;">(where photo was
                                    taken)</span></label>
                            <input type="text" id="asset-location" placeholder="e.g., Mount Bandai, Nagano Prefecture">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Tags <span style="color: var(--text-gray); font-size: 0.85rem;">(comma-separated for
                                filtering)</span></label>
                        <input type="text" id="asset-tags" placeholder="mountain, hiking, japan, nagano, adventure">
                    </div>

                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="asset-description"></textarea>
                    </div>

                    <div class="form-group">
                        <label>Alt Text (for images)</label>
                        <input type="text" id="asset-alt">
                    </div>

                    <div class="form-group">
                        <label>Keywords (comma-separated)</label>
                        <input type="text" id="asset-keywords" placeholder="real estate, nagano, japan">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>OG Title (Open Graph)</label>
                            <input type="text" id="asset-og-title">
                        </div>
                        <div class="form-group">
                            <label>OG Description</label>
                            <input type="text" id="asset-og-description">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Canonical URL</label>
                        <input type="url" id="asset-canonical">
                    </div>

                    <div class="form-group">
                        <label>Language</label>
                        <select id="asset-language">
                            <option value="en">English</option>
                            <option value="ja">Japanese</option>
                            <option value="zh">Chinese</option>
                            <option value="ko">Korean</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary">Upload Asset</button>
                </form>
            </div>

            <div class="card">
                <h2>Your Assets</h2>
                <div id="assets-grid" class="assets-grid">
                    <p>Loading assets...</p>
                </div>
            </div>
        </div>

        <!-- Knowledge Base Content -->
        <div id="knowledge-content" class="content-area">
            <div class="card">
                <h2>Add Knowledge Base Entry</h2>
                <form id="knowledge-form" onsubmit="saveKnowledgeEntry(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Category</label>
                            <select id="kb-category" required>
                                <option value="service">Service</option>
                                <option value="faq">FAQ</option>
                                <option value="company">Company</option>
                                <option value="area">Area</option>
                                <option value="process">Process</option>
                                <option value="general">General</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Language</label>
                            <select id="kb-language">
                                <option value="en">English</option>
                                <option value="ja">Japanese</option>
                                <option value="zh">Chinese</option>
                                <option value="ko">Korean</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Title</label>
                        <input type="text" id="kb-title" required>
                    </div>

                    <div class="form-group">
                        <label>Content</label>
                        <textarea id="kb-content" required></textarea>
                    </div>

                    <div class="form-group">
                        <label>Keywords (comma-separated)</label>
                        <input type="text" id="kb-keywords" placeholder="translation, property, nagano">
                    </div>

                    <div class="form-group">
                        <label>Priority (0-10, higher = more important)</label>
                        <input type="number" id="kb-priority" min="0" max="10" value="5">
                    </div>

                    <button type="submit" class="btn btn-primary">Save Knowledge Entry</button>
                </form>
            </div>

            <div class="card">
                <h2>Knowledge Base Entries</h2>
                <ul id="knowledge-list" class="knowledge-list">
                    <li>Loading...</li>
                </ul>
            </div>
        </div>

        <!-- Inquiries Content -->
        <div id="inquiries-content" class="content-area">
            <div class="card">
                <h2>Contact Inquiries</h2>
                <div id="inquiries-list">
                    <p>Loading inquiries...</p>
                </div>
            </div>
        </div>

        <!-- Email Templates Content -->
        <div id="email-templates-content" class="content-area">
            <div class="card">
                <h2>Email Templates</h2>
                <p style="margin-bottom: 1.5rem;">Create professional email templates for automated responses.</p>

                <form id="template-form" onsubmit="saveEmailTemplate(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Template Type</label>
                            <select id="template-type" required>
                                <option value="inquiry">Inquiry Auto-Response</option>
                                <option value="confirmation">Confirmation</option>
                                <option value="followup">Follow-up</option>
                                <option value="newsletter">Newsletter</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Language</label>
                            <select id="template-language">
                                <option value="en">English</option>
                                <option value="ja">Japanese</option>
                                <option value="zh">Chinese</option>
                                <option value="ko">Korean</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Subject</label>
                        <input type="text" id="template-subject" required
                            placeholder="Thank you for your inquiry - {{name}}">
                    </div>

                    <div class="form-group">
                        <label>HTML Body</label>
                        <textarea id="template-html" required
                            style="min-height: 300px; font-family: monospace;"></textarea>
                        <p style="font-size: 0.85rem; color: var(--text-gray); margin-top: 0.5rem;">
                            Available variables: {{name}}, {{email}}, {{message}}, {{subject}}, {{company}},
                            {{contact_email}}, {{contact_phone}}
                        </p>
                    </div>

                    <div class="form-group">
                        <label>Text Body (optional, for plain text emails)</label>
                        <textarea id="template-text" style="min-height: 150px;"></textarea>
                    </div>

                    <button type="submit" class="btn btn-primary">Save Template</button>
                </form>
            </div>

            <div class="card">
                <h2>Saved Templates</h2>
                <div id="templates-list">
                    <p>Loading templates...</p>
                </div>
            </div>
        </div>
    </main>

    <script src="themes.js"></script>
    <link rel="stylesheet" href="theme-styles.css">
    <script>
        const API_URL = 'https://shinshu-solutions.meauxbility.workers.dev';

        // Sidebar toggle
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const hamburger = document.querySelector('.hamburger');
            const mainContent = document.getElementById('mainContent');

            sidebar.classList.toggle('closed');
            hamburger.classList.toggle('active');
            mainContent.classList.toggle('sidebar-closed');
        }

        // Content switching
        function showContent(contentId) {
            window.currentContentId = contentId;

            // Hide all content areas
            document.querySelectorAll('.content-area').forEach(area => {
                area.classList.remove('active');
            });

            // Show selected content
            const targetContent = document.getElementById(contentId + '-content');
            if (targetContent) {
                targetContent.classList.add('active');
            }

            // Update nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            const activeNav = document.querySelector(`[onclick*="showContent('${contentId}')"]`);
            if (activeNav) {
                activeNav.classList.add('active');
            }

            // Update breadcrumbs
            updateBreadcrumbs(contentId);

            // Load data
            if (contentId === 'overview') loadOverview();
            if (contentId === 'clients') loadClients();
            if (contentId === 'properties') loadProperties();
            if (contentId === 'setup') loadSetup();
            if (contentId === 'customer-service') loadCustomerService();
            if (contentId === 'projects') loadProjects();
            if (contentId === 'services') loadServices();
            if (contentId === 'contacts') loadContacts();
            if (contentId === 'assets') loadAssets();
            if (contentId === 'knowledge') loadKnowledgeBase();
            if (contentId === 'inquiries') loadInquiries();
            if (contentId === 'email-templates') loadEmailTemplates();
            if (contentId === 'analytics') loadAnalytics();
            if (contentId === 'settings') loadSettings();
            if (contentId === 'assets') {
                setupDragAndDrop();
                loadAssets();
            }
            if (contentId === 'content-editor') loadContentEditor();

            // Close sidebar on mobile
            if (window.innerWidth <= 768) {
                toggleSidebar();
            }
        }

        function updateBreadcrumbs(contentId) {
            const titles = {
                'overview': 'Dashboard',
                'clients': 'Clients',
                'properties': 'Properties',
                'setup': 'Setup & Integrations',
                'customer-service': 'Customer Service',
                'projects': 'Projects',
                'services': 'Services',
                'contacts': 'Contacts',
                'content-editor': 'Content Editor',
                'assets': 'Assets & SEO',
                'knowledge': 'Knowledge Base',
                'inquiries': 'Inquiries',
                'email-templates': 'Email Templates',
                'analytics': 'Analytics',
                'settings': 'Settings'
            };

            document.getElementById('breadcrumbs').innerHTML = `
                <a href="/" class="breadcrumb-item">Home</a>
                <span class="breadcrumb-separator">/</span>
                <a href="/dashboard" class="breadcrumb-item">Dashboard</a>
                <span class="breadcrumb-separator">/</span>
                <span class="breadcrumb-current">${titles[contentId] || 'Dashboard'}</span>
            `;
        }

        // Asset Management
        // ===== DRAG & DROP FILE UPLOAD =====
        let selectedFiles = [];

        function setupDragAndDrop() {
            const dropZone = document.getElementById('drop-zone');
            if (!dropZone) return;

            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => {
                    dropZone.classList.add('drag-over');
                }, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => {
                    dropZone.classList.remove('drag-over');
                }, false);
            });

            dropZone.addEventListener('drop', handleDrop, false);
        }

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = Array.from(dt.files);
            handleFiles(files);
        }

        function handleFileSelect(event) {
            const files = Array.from(event.target.files);
            handleFiles(files);
        }

        function handleFiles(files) {
            selectedFiles = [...selectedFiles, ...files];
            updateFileList();
            updatePreview();
        }

        function updateFileList() {
            const fileList = document.getElementById('file-list');
            if (!fileList) return;

            if (selectedFiles.length === 0) {
                fileList.style.display = 'none';
                return;
            }

            fileList.style.display = 'block';
            fileList.innerHTML = selectedFiles.map((file, index) => {
                const size = (file.size / 1024).toFixed(1);
                const icon = file.type.startsWith('image/') ? 'ðŸ–¼ï¸' :
                    file.type.startsWith('video/') ? 'ðŸŽ¥' :
                        file.type.includes('pdf') ? 'ðŸ“„' : 'ðŸ“Ž';
                return `
                    <div class="file-item">
                        <div class="file-item-icon">${icon}</div>
                        <div class="file-item-info">
                            <div class="file-item-name">${file.name}</div>
                            <div class="file-item-size">${size} KB</div>
                        </div>
                        <button class="file-item-remove" onclick="removeFile(${index})" title="Remove">âœ•</button>
                    </div>
                `;
            }).join('');
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            updateFileList();
            updatePreview();

            // Update file input
            const fileInput = document.getElementById('asset-file');
            const dt = new DataTransfer();
            selectedFiles.forEach(file => dt.items.add(file));
            fileInput.files = dt.files;
        }

        function updatePreview() {
            const container = document.getElementById('preview-container');
            if (!container) return;

            container.innerHTML = '';
            selectedFiles.filter(f => f.type.startsWith('image/')).forEach(file => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'preview-image';
                    img.onclick = () => window.open(e.target.result);
                    container.appendChild(img);
                };
                reader.readAsDataURL(file);
            });
        }

        async function uploadAsset(event) {
            event.preventDefault();

            if (selectedFiles.length === 0) {
                alert('Please select at least one file');
                return;
            }

            const assetType = document.getElementById('asset-type').value;
            const title = document.getElementById('asset-title').value || selectedFiles[0].name;
            const description = document.getElementById('asset-description').value;
            const altText = document.getElementById('asset-alt').value;
            const keywords = document.getElementById('asset-keywords').value;
            const ogTitle = document.getElementById('asset-og-title').value;
            const ogDescription = document.getElementById('asset-og-description').value;
            const canonicalUrl = document.getElementById('asset-canonical').value;
            const language = document.getElementById('asset-language').value;

            // Upload files one by one
            let successCount = 0;
            let errorCount = 0;

            for (const file of selectedFiles) {
                try {
                    const formData = new FormData();
                    formData.append('file', file);
                    const category = document.getElementById('asset-category').value;
                    const location = document.getElementById('asset-location').value;
                    const tags = document.getElementById('asset-tags').value.split(',').map(t => t.trim()).filter(Boolean);

                    formData.append('metadata', JSON.stringify({
                        asset_type: assetType || (file.type.startsWith('image/') ? 'image' : 'document'),
                        title: title || file.name,
                        description: description,
                        alt_text: altText,
                        keywords: keywords,
                        og_title: ogTitle,
                        og_description: ogDescription,
                        canonical_url: canonicalUrl,
                        language_code: language,
                        metadata: {
                            category: category,
                            location: location,
                            tags: tags,
                        }
                    }));

                    const response = await fetch(`${API_URL}/api/assets/upload`, {
                        method: 'POST',
                        body: formData,
                    });

                    const data = await response.json();
                    if (data.success) {
                        successCount++;
                    } else {
                        errorCount++;
                        console.error('Upload error:', data.error);
                    }
                } catch (error) {
                    errorCount++;
                    console.error('Upload error:', error);
                }
            }

            if (successCount > 0) {
                alert(`âœ… Successfully uploaded ${successCount} file(s) to R2${errorCount > 0 ? `. ${errorCount} failed.` : ''}`);
                // Reset form
                document.getElementById('asset-upload-form').reset();
                selectedFiles = [];
                updateFileList();
                updatePreview();
                loadAssets(); // Reload to show new assets
            } else {
                alert(`âŒ Failed to upload files. Please try again.`);
            }
        } catch (error) {
            alert('Error uploading asset: ' + error.message);
        }
        }

        async function loadAssets() {
            try {
                const response = await fetch(`${API_URL}/api/assets?type=image&limit=100`);
                const data = await response.json();

                if (data.success) {
                    const grid = document.getElementById('assets-grid');
                    if (data.data.length === 0) {
                        grid.innerHTML = '<p>No assets uploaded yet. Upload images via drag & drop above.</p>';
                    } else {
                        // Filter to only show assets with r2_key (actually in R2)
                        const assetsWithR2 = data.data.filter(asset => asset.r2_key);

                        if (assetsWithR2.length === 0) {
                            grid.innerHTML = '<p style="color: #d32f2f;">âš ï¸ Assets found in database but not in R2. Please re-upload.</p>';
                            return;
                        }

                        grid.innerHTML = assetsWithR2.map(asset => {
                            const metadata = typeof asset.metadata === 'string' ? JSON.parse(asset.metadata || '{}') : (asset.metadata || {});
                            const category = metadata.category || 'uncategorized';
                            const location = metadata.location || '';
                            const tags = metadata.tags || [];

                            return `
                            <div class="asset-card" data-asset-id="${asset.id}">
                                ${asset.asset_type === 'image' ? `<img src="${API_URL}/api/assets/${asset.id}/view" alt="${asset.alt_text || asset.title}" loading="lazy" onerror="this.parentElement.querySelector('.asset-error').style.display='block'">` : ''}
                                <div class="asset-error" style="display: none; padding: 1rem; background: #ffebee; color: #c62828; border-radius: 8px; margin-bottom: 0.5rem;">
                                    âš ï¸ Image failed to load from R2
                                </div>
                                <div class="asset-card-body">
                                    <h3>${asset.title}</h3>
                                    <div style="font-size: 0.85rem; color: var(--text-gray); margin: 0.5rem 0;">
                                        <div><strong>Category:</strong> ${category || 'None'}</div>
                                        ${location ? `<div><strong>Location:</strong> ${location}</div>` : ''}
                                        ${tags.length > 0 ? `<div><strong>Tags:</strong> ${tags.join(', ')}</div>` : ''}
                                        <div><strong>Size:</strong> ${(asset.file_size / 1024).toFixed(1)} KB</div>
                                        <div style="margin-top: 0.5rem; padding: 0.5rem; background: #e8f5e9; border-radius: 4px; font-size: 0.75rem;">
                                            <strong>âœ… Synced:</strong> <code style="font-size: 0.7rem; word-break: break-all;">${asset.r2_key}</code>
                                        </div>
                                    </div>
                                    <p style="font-size: 0.9rem; color: var(--text-gray); margin: 0.5rem 0;">${asset.description || 'No description'}</p>
                                    <div class="asset-actions" style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                                        <button class="btn btn-secondary btn-small" onclick="editAsset('${asset.id}')">Edit SEO</button>
                                        <button class="btn btn-secondary btn-small" onclick="deleteAsset('${asset.id}')">Delete</button>
                                    </div>
                                </div>
                            </div>
                        `;
                        }).join('');
                    }
                }
            } catch (error) {
                console.error('Error loading assets:', error);
                document.getElementById('assets-grid').innerHTML = '<p style="color: #d32f2f;">Error loading assets. Please refresh.</p>';
            }
        }

        async function editAsset(id) {
            try {
                const response = await fetch(`${API_URL}/api/assets/${id}`);
                const data = await response.json();

                if (data.success) {
                    const asset = data.data;
                    const metadata = typeof asset.metadata === 'string' ? JSON.parse(asset.metadata || '{}') : (asset.metadata || {});

                    // Populate form with existing data
                    document.getElementById('asset-title').value = asset.title || '';
                    document.getElementById('asset-description').value = asset.description || '';
                    document.getElementById('asset-alt').value = asset.alt_text || '';
                    document.getElementById('asset-keywords').value = asset.keywords || '';
                    document.getElementById('asset-og-title').value = asset.og_title || '';
                    document.getElementById('asset-og-description').value = asset.og_description || '';
                    document.getElementById('asset-canonical').value = asset.canonical_url || '';
                    document.getElementById('asset-language').value = asset.language_code || 'en';
                    document.getElementById('asset-category').value = metadata.category || '';
                    document.getElementById('asset-location').value = metadata.location || '';
                    document.getElementById('asset-tags').value = (metadata.tags || []).join(', ');

                    // Scroll to form
                    document.getElementById('asset-upload-form').scrollIntoView({ behavior: 'smooth' });

                    // Show update button
                    const submitBtn = document.querySelector('#asset-upload-form button[type="submit"]');
                    submitBtn.textContent = 'Update Asset Metadata';
                    submitBtn.onclick = async (e) => {
                        e.preventDefault();
                        await updateAsset(id);
                    };
                }
            } catch (error) {
                alert('Error loading asset: ' + error.message);
            }
        }

        async function updateAsset(id) {
            const category = document.getElementById('asset-category').value;
            const location = document.getElementById('asset-location').value;
            const tags = document.getElementById('asset-tags').value.split(',').map(t => t.trim()).filter(Boolean);

            const metadata = {
                category: category,
                location: location,
                tags: tags,
            };

            const updateData = {
                title: document.getElementById('asset-title').value,
                description: document.getElementById('asset-description').value,
                alt_text: document.getElementById('asset-alt').value,
                keywords: document.getElementById('asset-keywords').value,
                og_title: document.getElementById('asset-og-title').value,
                og_description: document.getElementById('asset-og-description').value,
                canonical_url: document.getElementById('asset-canonical').value,
                metadata: metadata,
            };

            try {
                const response = await fetch(`${API_URL}/api/assets/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(updateData),
                });

                const data = await response.json();
                if (data.success) {
                    alert('âœ… Asset metadata updated! Changes will appear on the live site immediately.');
                    document.getElementById('asset-upload-form').reset();
                    const submitBtn = document.querySelector('#asset-upload-form button[type="submit"]');
                    submitBtn.textContent = 'Upload Asset';
                    submitBtn.onclick = null;
                    loadAssets();
                } else {
                    alert('Error: ' + (data.error || 'Failed to update'));
                }
            } catch (error) {
                alert('Error updating asset: ' + error.message);
            }
        }

        async function deleteAsset(id) {
            if (!confirm('Delete this asset? This will remove it from R2 and the database. This cannot be undone.')) return;

            try {
                const response = await fetch(`${API_URL}/api/assets/${id}`, { method: 'DELETE' });
                const data = await response.json();

                if (data.success) {
                    alert('âœ… Asset deleted from R2 and database.');
                    loadAssets();
                } else {
                    alert('Error: ' + (data.error || 'Failed to delete'));
                }
            } catch (error) {
                alert('Error deleting asset: ' + error.message);
            }
        }
                                    <p>${asset.description || 'No description'}</p>
                                    <p style="font-size: 0.75rem; color: #999;">${asset.asset_type} â€¢ ${(asset.file_size / 1024).toFixed(1)} KB</p>
                                    <div class="asset-actions">
                                        <button class="btn btn-secondary btn-small" onclick="editAsset('${asset.id}')">Edit SEO</button>
                                        <button class="btn btn-secondary btn-small" onclick="deleteAsset('${asset.id}')">Delete</button>
                                    </div>
                                </div >
                            </div >
            `).join('');
                    }
                }
            } catch (error) {
                console.error('Error loading assets:', error);
            }
        }

        // Knowledge Base
        async function saveKnowledgeEntry(event) {
            event.preventDefault();

            const data = {
                category: document.getElementById('kb-category').value,
                language_code: document.getElementById('kb-language').value,
                title: document.getElementById('kb-title').value,
                content: document.getElementById('kb-content').value,
                keywords: document.getElementById('kb-keywords').value,
                priority: parseInt(document.getElementById('kb-priority').value),
            };

            try {
                const response = await fetch(`${ API_URL } /api/knowledge`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });

                const result = await response.json();
                if (result.success) {
                    alert('Knowledge entry saved!');
                    document.getElementById('knowledge-form').reset();
                    loadKnowledgeBase();
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                alert('Error saving entry: ' + error.message);
            }
        }

        async function loadKnowledgeBase() {
            try {
                const response = await fetch(`${ API_URL } /api/knowledge`);
                const data = await response.json();

                if (data.success) {
                    const list = document.getElementById('knowledge-list');
                    if (data.data.length === 0) {
                        list.innerHTML = '<li>No knowledge entries yet.</li>';
                    } else {
                        list.innerHTML = data.data.map(kb => `
            < li class="knowledge-item" >
                                <h3>${kb.title}</h3>
                                <div class="meta">${kb.category} â€¢ ${kb.language_code.toUpperCase()} â€¢ Priority: ${kb.priority}</div>
                                <p>${kb.content.substring(0, 200)}${kb.content.length > 200 ? '...' : ''}</p>
                                <div style="margin-top: 1rem;">
                                    <button class="btn btn-secondary btn-small" onclick="deleteKnowledge('${kb.id}')">Delete</button>
                                </div>
                            </li >
            `).join('');
                    }
                }
            } catch (error) {
                console.error('Error loading knowledge base:', error);
            }
        }

        // Inquiries
        async function loadInquiries() {
            try {
                const response = await fetch(`${ API_URL } /api/inquiries`);
                const data = await response.json();

                if (data.success) {
                    const list = document.getElementById('inquiries-list');
                    if (data.data.length === 0) {
                        list.innerHTML = '<p>No inquiries yet.</p>';
                    } else {
                        list.innerHTML = data.data.map(inq => `
            < div class="inquiry-item" >
                                <h3>${inq.subject || 'No Subject'}</h3>
                                <div class="meta">
                                    ${inq.name} (${inq.email}) â€¢ ${new Date(inq.created_at * 1000).toLocaleDateString()} â€¢ 
                                    <span class="status-badge status-${inq.status}">${inq.status}</span>
                                </div>
                                <div class="message">
                                    <p>${inq.message}</p>
                                </div>
                                <div style="margin-top: 1rem;">
                                    <button class="btn btn-primary btn-small" onclick="markResponded('${inq.id}')">Mark as Responded</button>
                                </div>
                            </div >
            `).join('');
                    }
                }
            } catch (error) {
                console.error('Error loading inquiries:', error);
            }
        }

        // Email Templates
        async function saveEmailTemplate(event) {
            event.preventDefault();

            const data = {
                template_type: document.getElementById('template-type').value,
                language_code: document.getElementById('template-language').value,
                subject: document.getElementById('template-subject').value,
                html_body: document.getElementById('template-html').value,
                text_body: document.getElementById('template-text').value,
            };

            try {
                const response = await fetch(`${ API_URL } /api/email - templates`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });

                const result = await response.json();
                if (result.success) {
                    alert('Template saved!');
                    document.getElementById('template-form').reset();
                    loadEmailTemplates();
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                alert('Error saving template: ' + error.message);
            }
        }

        async function loadEmailTemplates() {
            try {
                const response = await fetch(`${ API_URL } /api/email - templates`);
                const data = await response.json();

                if (data.success) {
                    const list = document.getElementById('templates-list');
                    if (data.data.length === 0) {
                        list.innerHTML = '<p>No templates yet.</p>';
                    } else {
                        list.innerHTML = data.data.map(tpl => `
            < div class="knowledge-item" >
                                <h3>${tpl.template_type} (${tpl.language_code.toUpperCase()})</h3>
                                <p><strong>Subject:</strong> ${tpl.subject}</p>
                                <div style="margin-top: 1rem;">
                                    <button class="btn btn-secondary btn-small" onclick="deleteTemplate('${tpl.id}')">Delete</button>
                                </div>
                            </div >
            `).join('');
                    }
                }
            } catch (error) {
                console.error('Error loading templates:', error);
            }
        }

        // Helper functions
        async function deleteAsset(id) {
            if (!confirm('Delete this asset?')) return;
            try {
                const response = await fetch(`${ API_URL } /api/assets / ${ id } `, { method: 'DELETE' });
                const data = await response.json();
                if (data.success) {
                    loadAssets();
                }
            } catch (error) {
                alert('Error deleting asset');
            }
        }

        async function deleteKnowledge(id) {
            if (!confirm('Delete this knowledge entry?')) return;
            try {
                const response = await fetch(`${ API_URL } /api/knowledge / ${ id } `, { method: 'DELETE' });
                const data = await response.json();
                if (data.success) {
                    loadKnowledgeBase();
                }
            } catch (error) {
                alert('Error deleting entry');
            }
        }

        async function markResponded(id) {
            try {
                const response = await fetch(`${ API_URL } /api/inquiries / ${ id } `, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ status: 'responded' }),
                });
                const data = await response.json();
                if (data.success) {
                    loadInquiries();
                }
            } catch (error) {
                alert('Error updating inquiry');
            }
        }

        async function deleteTemplate(id) {
            if (!confirm('Delete this template?')) return;
            try {
                const response = await fetch(`${ API_URL } /api/email - templates / ${ id } `, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ is_active: 0 }),
                });
                const data = await response.json();
                if (data.success) {
                    loadEmailTemplates();
                }
            } catch (error) {
                alert('Error deleting template');
            }
        }

        // Initialize theme system
        document.addEventListener('DOMContentLoaded', () => {
            if (window.initTheme) {
                window.initTheme();
            }
        });

        // ===== OVERVIEW/DASHBOARD =====
        async function loadOverview() {
            try {
                const [clientsRes, propertiesRes, projectsRes, inquiriesRes] = await Promise.all([
                    fetch(`${ API_URL } /api/clients`),
                    fetch(`${ API_URL } /api/properties`),
                    fetch(`${ API_URL } /api/projects`),
                    fetch(`${ API_URL } /api/inquiries ? status = new `)
                ]);

                const clients = await clientsRes.json();
                const properties = await propertiesRes.json();
                const projects = await projectsRes.json();
                const inquiries = await inquiriesRes.json();

                document.getElementById('stat-clients').textContent = clients.data?.length || 0;
                document.getElementById('stat-properties').textContent = properties.data?.length || 0;
                document.getElementById('stat-projects').textContent = projects.data?.filter(p => p.status === 'in_progress' || p.status === 'planning').length || 0;
                document.getElementById('stat-inquiries').textContent = inquiries.data?.length || 0;

                // Load recent activity
                loadRecentActivity();
            } catch (error) {
                console.error('Error loading overview:', error);
            }
        }

        async function loadRecentActivity() {
            const activity = [];
            try {
                const [clients, projects, inquiries] = await Promise.all([
                    fetch(`${ API_URL } /api/clients`).then(r => r.json()),
                    fetch(`${ API_URL } /api/projects`).then(r => r.json()),
                    fetch(`${ API_URL } /api/inquiries`).then(r => r.json())
                ]);

                // Combine and sort by date
                if (clients.data) {
                    clients.data.slice(0, 3).forEach(c => {
                        activity.push({ type: 'client', text: `New client: ${ c.name } `, date: c.created_at });
                    });
                }
                if (projects.data) {
                    projects.data.slice(0, 3).forEach(p => {
                        activity.push({ type: 'project', text: `Project: ${ p.name } `, date: p.created_at });
                    });
                }
                if (inquiries.data) {
                    inquiries.data.slice(0, 3).forEach(i => {
                        activity.push({ type: 'inquiry', text: `Inquiry from ${ i.name } `, date: i.created_at });
                    });
                }

                activity.sort((a, b) => b.date - a.date);

                const container = document.getElementById('recent-activity');
                if (activity.length === 0) {
                    container.innerHTML = '<p>No recent activity</p>';
                } else {
                    container.innerHTML = activity.slice(0, 10).map(item => `
            < div style = "padding: 1rem; border-bottom: 1px solid color-mix(in srgb, var(--orange-primary) 10%, transparent);" >
                <div style="display: flex; justify-content: space-between;">
                    <span>${item.text}</span>
                    <span style="color: var(--text-gray); font-size: 0.85rem;">${new Date(item.date * 1000).toLocaleDateString()}</span>
                </div>
                        </div >
            `).join('');
                }
            } catch (error) {
                console.error('Error loading activity:', error);
            }
        }

        // ===== CLIENTS MANAGEMENT =====
        async function loadClients() {
            try {
                const response = await fetch(`${ API_URL } /api/clients`);
                const data = await response.json();

                if (data.success) {
                    window.allClients = data.data || [];
                    renderClientsTable(window.allClients);
                }
            } catch (error) {
                console.error('Error loading clients:', error);
            }
        }

        function renderClientsTable(clients) {
            const tbody = document.getElementById('clients-table-body');
            if (clients.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 2rem;">No clients yet. Add your first client!</td></tr>';
            } else {
                tbody.innerHTML = clients.map(client => `
            < tr >
                        <td><strong>${client.name || 'N/A'}</strong></td>
                        <td>${client.email || 'â€”'}</td>
                        <td>${client.phone || 'â€”'}</td>
                        <td>${client.country || 'â€”'}</td>
                        <td><span class="status-badge ${client.status === 'active' ? 'status-responded' : 'status-new'}">${client.status || 'active'}</span></td>
                        <td>
                            <button class="btn btn-secondary btn-small" onclick="editClient('${client.id}')">Edit</button>
                            <button class="btn btn-secondary btn-small" onclick="deleteClient('${client.id}')">Delete</button>
                        </td>
                    </tr >
            `).join('');
            }
        }

        function filterClients() {
            const search = document.getElementById('client-search').value.toLowerCase();
            const filtered = (window.allClients || []).filter(c =>
                c.name?.toLowerCase().includes(search) ||
                c.email?.toLowerCase().includes(search) ||
                c.company?.toLowerCase().includes(search)
            );
            renderClientsTable(filtered);
        }

        function openClientModal(clientId = null) {
            const modal = document.getElementById('client-modal');
            if (!modal) {
                createClientModal();
            }
            const modalEl = document.getElementById('client-modal');
            modalEl.classList.add('open');

            if (clientId) {
                // Load client data for editing
                loadClientData(clientId);
            } else {
                document.getElementById('client-form').reset();
                document.getElementById('client-form').dataset.mode = 'create';
            }
        }

        function createClientModal() {
            const modal = document.createElement('div');
            modal.id = 'client-modal';
            modal.className = 'modal';
            modal.innerHTML = `
            < div class="modal-content" >
                    <div class="modal-header">
                        <h3 id="client-modal-title">Add Client</h3>
                        <button class="modal-close" onclick="closeModal('client-modal')">&times;</button>
                    </div>
                    <form id="client-form" onsubmit="saveClient(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Name *</label>
                                <input type="text" id="client-name" required>
                            </div>
                            <div class="form-group">
                                <label>Company</label>
                                <input type="text" id="client-company">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="client-email">
                            </div>
                            <div class="form-group">
                                <label>Phone</label>
                                <input type="tel" id="client-phone">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Address</label>
                                <input type="text" id="client-address">
                            </div>
                            <div class="form-group">
                                <label>City</label>
                                <input type="text" id="client-city">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>State</label>
                                <input type="text" id="client-state">
                            </div>
                            <div class="form-group">
                                <label>ZIP</label>
                                <input type="text" id="client-zip">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Country</label>
                                <input type="text" id="client-country" value="USA">
                            </div>
                            <div class="form-group">
                                <label>Status</label>
                                <select id="client-status">
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                    <option value="archived">Archived</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Notes</label>
                            <textarea id="client-notes" rows="3"></textarea>
                        </div>
                        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                            <button type="submit" class="btn btn-primary">Save Client</button>
                            <button type="button" class="btn btn-secondary" onclick="closeModal('client-modal')">Cancel</button>
                        </div>
                    </form>
                </div >
            `;
            document.body.appendChild(modal);
        }

        async function saveClient(event) {
            event.preventDefault();
            const form = document.getElementById('client-form');
            const mode = form.dataset.mode || 'create';
            const clientId = form.dataset.clientId;

            const data = {
                name: document.getElementById('client-name').value,
                company: document.getElementById('client-company').value,
                email: document.getElementById('client-email').value,
                phone: document.getElementById('client-phone').value,
                address: document.getElementById('client-address').value,
                city: document.getElementById('client-city').value,
                state: document.getElementById('client-state').value,
                zip: document.getElementById('client-zip').value,
                country: document.getElementById('client-country').value,
                status: document.getElementById('client-status').value,
                notes: document.getElementById('client-notes').value,
            };

            try {
                const url = mode === 'edit' ? `${ API_URL } /api/clients / ${ clientId } ` : `${ API_URL } /api/clients`;
                const method = mode === 'edit' ? 'PUT' : 'POST';

                const response = await fetch(url, {
                    method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });

                const result = await response.json();
                if (result.success) {
                    closeModal('client-modal');
                    loadClients();
                    if (contentId === 'overview') loadOverview();
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                alert('Error saving client: ' + error.message);
            }
        }

        async function editClient(id) {
            try {
                const response = await fetch(`${ API_URL } /api/clients / ${ id } `);
                const data = await response.json();

                if (data.success) {
                    const client = data.data;
                    openClientModal();
                    document.getElementById('client-name').value = client.name || '';
                    document.getElementById('client-company').value = client.company || '';
                    document.getElementById('client-email').value = client.email || '';
                    document.getElementById('client-phone').value = client.phone || '';
                    document.getElementById('client-address').value = client.address || '';
                    document.getElementById('client-city').value = client.city || '';
                    document.getElementById('client-state').value = client.state || '';
                    document.getElementById('client-zip').value = client.zip || '';
                    document.getElementById('client-country').value = client.country || 'USA';
                    document.getElementById('client-status').value = client.status || 'active';
                    document.getElementById('client-notes').value = client.notes || '';
                    document.getElementById('client-form').dataset.mode = 'edit';
                    document.getElementById('client-form').dataset.clientId = id;
                    document.getElementById('client-modal-title').textContent = 'Edit Client';
                }
            } catch (error) {
                alert('Error loading client: ' + error.message);
            }
        }

        async function deleteClient(id) {
            if (!confirm('Delete this client? This action cannot be undone.')) return;
            try {
                const response = await fetch(`${ API_URL } /api/clients / ${ id } `, { method: 'DELETE' });
                const data = await response.json();
                if (data.success) {
                    loadClients();
                    if (contentId === 'overview') loadOverview();
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                alert('Error deleting client');
            }
        }

        function addNewClient() {
            openClientModal();
        }

        // ===== PROPERTIES MANAGEMENT =====
        async function loadProperties() {
            try {
                const response = await fetch(`${ API_URL } /api/properties`);
                const data = await response.json();

                if (data.success) {
                    window.allProperties = data.data || [];
                    renderPropertiesTable(window.allProperties);

                    // Load clients for filter
                    const clientsRes = await fetch(`${ API_URL } /api/clients`);
                    const clientsData = await clientsRes.json();
                    const filterSelect = document.getElementById('property-filter-client');
                    if (filterSelect && clientsData.data) {
                        filterSelect.innerHTML = '<option value="">All Clients</option>' +
                            clientsData.data.map(c => `< option value = "${c.id}" > ${ c.name }</option > `).join('');
                    }
                }
            } catch (error) {
                console.error('Error loading properties:', error);
            }
        }

        function renderPropertiesTable(properties) {
            const tbody = document.getElementById('properties-table-body');
            if (properties.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 2rem;">No properties yet. Add your first property!</td></tr>';
            } else {
                tbody.innerHTML = properties.map(prop => `
            < tr >
                        <td><strong>${prop.name || 'N/A'}</strong></td>
                        <td>${prop.address || 'â€”'}, ${prop.city || ''} ${prop.state || ''}</td>
                        <td>${prop.property_type || 'â€”'}</td>
                        <td><span class="status-badge ${prop.status === 'active' ? 'status-responded' : 'status-new'}">${prop.status || 'active'}</span></td>
                        <td>${prop.current_value ? 'Â¥' + prop.current_value.toLocaleString() : 'â€”'}</td>
                        <td>
                            <button class="btn btn-secondary btn-small" onclick="editProperty('${prop.id}')">Edit</button>
                            <button class="btn btn-secondary btn-small" onclick="deleteProperty('${prop.id}')">Delete</button>
                        </td>
                    </tr >
            `).join('');
            }
        }

        function filterProperties() {
            const search = document.getElementById('property-search').value.toLowerCase();
            const clientFilter = document.getElementById('property-filter-client').value;

            let filtered = (window.allProperties || []);

            if (clientFilter) {
                filtered = filtered.filter(p => p.client_id === clientFilter);
            }

            if (search) {
                filtered = filtered.filter(p =>
                    p.name?.toLowerCase().includes(search) ||
                    p.address?.toLowerCase().includes(search) ||
                    p.city?.toLowerCase().includes(search)
                );
            }

            renderPropertiesTable(filtered);
        }

        function openPropertyModal(propertyId = null) {
            // Similar to client modal - create if needed
            if (!document.getElementById('property-modal')) {
                createPropertyModal();
            }
            const modal = document.getElementById('property-modal');
            modal.classList.add('open');

            if (propertyId) {
                loadPropertyData(propertyId);
            } else {
                document.getElementById('property-form').reset();
                document.getElementById('property-form').dataset.mode = 'create';
            }
        }

        function createPropertyModal() {
            const modal = document.createElement('div');
            modal.id = 'property-modal';
            modal.className = 'modal';
            modal.innerHTML = `
            < div class="modal-content" >
                    <div class="modal-header">
                        <h3 id="property-modal-title">Add Property</h3>
                        <button class="modal-close" onclick="closeModal('property-modal')">&times;</button>
                    </div>
                    <form id="property-form" onsubmit="saveProperty(event)">
                        <div class="form-group">
                            <label>Client</label>
                            <select id="property-client-id">
                                <option value="">No Client</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Property Name *</label>
                            <input type="text" id="property-name" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Address *</label>
                                <input type="text" id="property-address" required>
                            </div>
                            <div class="form-group">
                                <label>City *</label>
                                <input type="text" id="property-city" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>State *</label>
                                <input type="text" id="property-state" required>
                            </div>
                            <div class="form-group">
                                <label>ZIP *</label>
                                <input type="text" id="property-zip" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Property Type</label>
                                <select id="property-type">
                                    <option value="residential">Residential</option>
                                    <option value="commercial">Commercial</option>
                                    <option value="industrial">Industrial</option>
                                    <option value="land">Land</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Status</label>
                                <select id="property-status">
                                    <option value="active">Active</option>
                                    <option value="sold">Sold</option>
                                    <option value="pending">Pending</option>
                                    <option value="off-market">Off Market</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Square Feet</label>
                                <input type="number" id="property-square-feet">
                            </div>
                            <div class="form-group">
                                <label>Current Value (Â¥)</label>
                                <input type="number" id="property-value" step="0.01">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Notes</label>
                            <textarea id="property-notes" rows="3"></textarea>
                        </div>
                        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                            <button type="submit" class="btn btn-primary">Save Property</button>
                            <button type="button" class="btn btn-secondary" onclick="closeModal('property-modal')">Cancel</button>
                        </div>
                    </form>
                </div >
            `;
            document.body.appendChild(modal);

            // Load clients for dropdown
            fetch(`${ API_URL } /api/clients`).then(r => r.json()).then(data => {
                if (data.success) {
                    const select = document.getElementById('property-client-id');
                    select.innerHTML = '<option value="">No Client</option>' +
                        data.data.map(c => `< option value = "${c.id}" > ${ c.name }</option > `).join('');
                }
            });
        }

        async function saveProperty(event) {
            event.preventDefault();
            const form = document.getElementById('property-form');
            const mode = form.dataset.mode || 'create';
            const propertyId = form.dataset.propertyId;

            const data = {
                client_id: document.getElementById('property-client-id').value || null,
                name: document.getElementById('property-name').value,
                address: document.getElementById('property-address').value,
                city: document.getElementById('property-city').value,
                state: document.getElementById('property-state').value,
                zip: document.getElementById('property-zip').value,
                property_type: document.getElementById('property-type').value,
                status: document.getElementById('property-status').value,
                square_feet: document.getElementById('property-square-feet').value ? parseInt(document.getElementById('property-square-feet').value) : null,
                current_value: document.getElementById('property-value').value ? parseFloat(document.getElementById('property-value').value) : null,
                notes: document.getElementById('property-notes').value,
            };

            try {
                const url = mode === 'edit' ? `${ API_URL } /api/properties / ${ propertyId } ` : `${ API_URL } /api/properties`;
                const method = mode === 'edit' ? 'PUT' : 'POST';

                const response = await fetch(url, {
                    method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });

                const result = await response.json();
                if (result.success) {
                    closeModal('property-modal');
                    loadProperties();
                    if (contentId === 'overview') loadOverview();
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                alert('Error saving property: ' + error.message);
            }
        }

        async function editProperty(id) {
            try {
                const response = await fetch(`${ API_URL } /api/properties / ${ id } `);
                const data = await response.json();

                if (data.success) {
                    const prop = data.data;
                    openPropertyModal();
                    document.getElementById('property-client-id').value = prop.client_id || '';
                    document.getElementById('property-name').value = prop.name || '';
                    document.getElementById('property-address').value = prop.address || '';
                    document.getElementById('property-city').value = prop.city || '';
                    document.getElementById('property-state').value = prop.state || '';
                    document.getElementById('property-zip').value = prop.zip || '';
                    document.getElementById('property-type').value = prop.property_type || 'residential';
                    document.getElementById('property-status').value = prop.status || 'active';
                    document.getElementById('property-square-feet').value = prop.square_feet || '';
                    document.getElementById('property-value').value = prop.current_value || '';
                    document.getElementById('property-notes').value = prop.notes || '';
                    document.getElementById('property-form').dataset.mode = 'edit';
                    document.getElementById('property-form').dataset.propertyId = id;
                    document.getElementById('property-modal-title').textContent = 'Edit Property';
                }
            } catch (error) {
                alert('Error loading property: ' + error.message);
            }
        }

        async function deleteProperty(id) {
            if (!confirm('Delete this property?')) return;
            try {
                const response = await fetch(`${ API_URL } /api/properties / ${ id } `, { method: 'DELETE' });
                const data = await response.json();
                if (data.success) {
                    loadProperties();
                    if (contentId === 'overview') loadOverview();
                }
            } catch (error) {
                alert('Error deleting property');
            }
        }

        function addNewProperty() {
            openPropertyModal();
        }

        // ===== PROJECTS MANAGEMENT =====
        async function loadProjects() {
            try {
                const response = await fetch(`${ API_URL } /api/projects`);
                const data = await response.json();

                if (data.success) {
                    window.allProjects = data.data || [];
                    renderProjectsTable(window.allProjects);
                }
            } catch (error) {
                console.error('Error loading projects:', error);
            }
        }

        function renderProjectsTable(projects) {
            const tbody = document.getElementById('projects-table-body');
            if (projects.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 2rem;">No projects yet. Create your first project!</td></tr>';
            } else {
                tbody.innerHTML = projects.map(proj => {
                    const statusClass = proj.status === 'completed' ? 'status-responded' :
                        proj.status === 'in_progress' ? 'status-new' : 'status-new';
                    return `
            < tr >
                            <td><strong>${proj.name || 'N/A'}</strong></td>
                            <td>${proj.project_type || 'â€”'}</td>
                            <td><span class="status-badge ${statusClass}">${proj.status || 'planning'}</span></td>
                            <td>${proj.budget ? 'Â¥' + proj.budget.toLocaleString() : 'â€”'}</td>
                            <td>${proj.priority || 'medium'}</td>
                            <td>
                                <button class="btn btn-secondary btn-small" onclick="editProject('${proj.id}')">Edit</button>
                                <button class="btn btn-secondary btn-small" onclick="deleteProject('${proj.id}')">Delete</button>
                            </td>
                        </tr >
            `;
                }).join('');
            }
        }

        function filterProjects() {
            const search = document.getElementById('project-search').value.toLowerCase();
            const statusFilter = document.getElementById('project-filter-status').value;

            let filtered = (window.allProjects || []);

            if (statusFilter) {
                filtered = filtered.filter(p => p.status === statusFilter);
            }

            if (search) {
                filtered = filtered.filter(p =>
                    p.name?.toLowerCase().includes(search) ||
                    p.description?.toLowerCase().includes(search) ||
                    p.project_type?.toLowerCase().includes(search)
                );
            }

            renderProjectsTable(filtered);
        }

        function openProjectModal(projectId = null) {
            if (!document.getElementById('project-modal')) {
                createProjectModal();
            }
            const modal = document.getElementById('project-modal');
            modal.classList.add('open');

            if (projectId) {
                loadProjectData(projectId);
            } else {
                document.getElementById('project-form').reset();
                document.getElementById('project-form').dataset.mode = 'create';
            }
        }

        function createProjectModal() {
            const modal = document.createElement('div');
            modal.id = 'project-modal';
            modal.className = 'modal';
            modal.innerHTML = `
            < div class="modal-content" >
                    <div class="modal-header">
                        <h3 id="project-modal-title">New Project</h3>
                        <button class="modal-close" onclick="closeModal('project-modal')">&times;</button>
                    </div>
                    <form id="project-form" onsubmit="saveProject(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Client</label>
                                <select id="project-client-id">
                                    <option value="">No Client</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Property</label>
                                <select id="project-property-id">
                                    <option value="">No Property</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Project Name *</label>
                            <input type="text" id="project-name" required>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="project-description" rows="3"></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Project Type</label>
                                <select id="project-type">
                                    <option value="construction">Construction</option>
                                    <option value="renovation">Renovation</option>
                                    <option value="maintenance">Maintenance</option>
                                    <option value="inspection">Inspection</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Status</label>
                                <select id="project-status">
                                    <option value="planning">Planning</option>
                                    <option value="in_progress">In Progress</option>
                                    <option value="on_hold">On Hold</option>
                                    <option value="completed">Completed</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Budget (Â¥)</label>
                                <input type="number" id="project-budget" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Priority</label>
                                <select id="project-priority">
                                    <option value="low">Low</option>
                                    <option value="medium" selected>Medium</option>
                                    <option value="high">High</option>
                                    <option value="urgent">Urgent</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Notes</label>
                            <textarea id="project-notes" rows="3"></textarea>
                        </div>
                        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                            <button type="submit" class="btn btn-primary">Save Project</button>
                            <button type="button" class="btn btn-secondary" onclick="closeModal('project-modal')">Cancel</button>
                        </div>
                    </form>
                </div >
            `;
            document.body.appendChild(modal);

            // Load clients and properties
            Promise.all([
                fetch(`${ API_URL } /api/clients`).then(r => r.json()),
                fetch(`${ API_URL } /api/properties`).then(r => r.json())
            ]).then(([clients, properties]) => {
                if (clients.success) {
                    const clientSelect = document.getElementById('project-client-id');
                    clientSelect.innerHTML = '<option value="">No Client</option>' +
                        clients.data.map(c => `< option value = "${c.id}" > ${ c.name }</option > `).join('');
                }
                if (properties.success) {
                    const propSelect = document.getElementById('project-property-id');
                    propSelect.innerHTML = '<option value="">No Property</option>' +
                        properties.data.map(p => `< option value = "${p.id}" > ${ p.name }</option > `).join('');
                }
            });
        }

        async function saveProject(event) {
            event.preventDefault();
            const form = document.getElementById('project-form');
            const mode = form.dataset.mode || 'create';
            const projectId = form.dataset.projectId;

            const data = {
                client_id: document.getElementById('project-client-id').value || null,
                property_id: document.getElementById('project-property-id').value || null,
                name: document.getElementById('project-name').value,
                description: document.getElementById('project-description').value,
                project_type: document.getElementById('project-type').value,
                status: document.getElementById('project-status').value,
                budget: document.getElementById('project-budget').value ? parseFloat(document.getElementById('project-budget').value) : null,
                priority: document.getElementById('project-priority').value,
                notes: document.getElementById('project-notes').value,
            };

            try {
                const url = mode === 'edit' ? `${ API_URL } /api/projects / ${ projectId } ` : `${ API_URL } /api/projects`;
                const method = mode === 'edit' ? 'PUT' : 'POST';

                const response = await fetch(url, {
                    method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });

                const result = await response.json();
                if (result.success) {
                    closeModal('project-modal');
                    loadProjects();
                    if (contentId === 'overview') loadOverview();
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                alert('Error saving project: ' + error.message);
            }
        }

        async function editProject(id) {
            try {
                const response = await fetch(`${ API_URL } /api/projects / ${ id } `);
                const data = await response.json();

                if (data.success) {
                    const proj = data.data;
                    openProjectModal();
                    document.getElementById('project-client-id').value = proj.client_id || '';
                    document.getElementById('project-property-id').value = proj.property_id || '';
                    document.getElementById('project-name').value = proj.name || '';
                    document.getElementById('project-description').value = proj.description || '';
                    document.getElementById('project-type').value = proj.project_type || 'construction';
                    document.getElementById('project-status').value = proj.status || 'planning';
                    document.getElementById('project-budget').value = proj.budget || '';
                    document.getElementById('project-priority').value = proj.priority || 'medium';
                    document.getElementById('project-notes').value = proj.notes || '';
                    document.getElementById('project-form').dataset.mode = 'edit';
                    document.getElementById('project-form').dataset.projectId = id;
                    document.getElementById('project-modal-title').textContent = 'Edit Project';
                }
            } catch (error) {
                alert('Error loading project: ' + error.message);
            }
        }

        async function deleteProject(id) {
            if (!confirm('Delete this project?')) return;
            try {
                const response = await fetch(`${ API_URL } /api/projects / ${ id } `, { method: 'DELETE' });
                const data = await response.json();
                if (data.success) {
                    loadProjects();
                    if (contentId === 'overview') loadOverview();
                }
            } catch (error) {
                alert('Error deleting project');
            }
        }

        function addNewProject() {
            openProjectModal();
        }

        // ===== SERVICES MANAGEMENT =====
        async function loadServices() {
            try {
                const response = await fetch(`${ API_URL } /api/services`);
                const data = await response.json();

                if (data.success) {
                    window.allServices = data.data || [];
                    renderServicesTable(window.allServices);
                }
            } catch (error) {
                console.error('Error loading services:', error);
            }
        }

        function renderServicesTable(services) {
            const tbody = document.getElementById('services-table-body');
            if (services.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 2rem;">No services yet.</td></tr>';
            } else {
                tbody.innerHTML = services.map(svc => `
            < tr >
                        <td><strong>${svc.name || 'N/A'}</strong></td>
                        <td>${svc.project_id ? 'Project ' + svc.project_id.substring(0, 8) : 'â€”'}</td>
                        <td>${svc.service_type || 'â€”'}</td>
                        <td><span class="status-badge ${svc.status === 'completed' ? 'status-responded' : 'status-new'}">${svc.status || 'pending'}</span></td>
                        <td>${svc.total_price ? 'Â¥' + svc.total_price.toLocaleString() : 'â€”'}</td>
                        <td>
                            <button class="btn btn-secondary btn-small" onclick="editService('${svc.id}')">Edit</button>
                            <button class="btn btn-secondary btn-small" onclick="deleteService('${svc.id}')">Delete</button>
                        </td>
                    </tr >
            `).join('');
            }
        }

        function openServiceModal(serviceId = null) {
            if (!document.getElementById('service-modal')) {
                createServiceModal();
            }
            const modal = document.getElementById('service-modal');
            modal.classList.add('open');

            if (serviceId) {
                loadServiceData(serviceId);
            } else {
                document.getElementById('service-form').reset();
                document.getElementById('service-form').dataset.mode = 'create';
            }
        }

        function createServiceModal() {
            const modal = document.createElement('div');
            modal.id = 'service-modal';
            modal.className = 'modal';
            modal.innerHTML = `
            < div class="modal-content" >
                    <div class="modal-header">
                        <h3 id="service-modal-title">Add Service</h3>
                        <button class="modal-close" onclick="closeModal('service-modal')">&times;</button>
                    </div>
                    <form id="service-form" onsubmit="saveService(event)">
                        <div class="form-group">
                            <label>Project</label>
                            <select id="service-project-id">
                                <option value="">No Project</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Service Name *</label>
                            <input type="text" id="service-name" required>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="service-description" rows="3"></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Service Type</label>
                                <select id="service-type">
                                    <option value="design">Design</option>
                                    <option value="construction">Construction</option>
                                    <option value="consulting">Consulting</option>
                                    <option value="maintenance">Maintenance</option>
                                    <option value="inspection">Inspection</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Status</label>
                                <select id="service-status">
                                    <option value="pending">Pending</option>
                                    <option value="in_progress">In Progress</option>
                                    <option value="completed">Completed</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Unit Price (Â¥)</label>
                                <input type="number" id="service-unit-price" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Quantity</label>
                                <input type="number" id="service-quantity" value="1" step="0.01">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Notes</label>
                            <textarea id="service-notes" rows="3"></textarea>
                        </div>
                        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                            <button type="submit" class="btn btn-primary">Save Service</button>
                            <button type="button" class="btn btn-secondary" onclick="closeModal('service-modal')">Cancel</button>
                        </div>
                    </form>
                </div >
            `;
            document.body.appendChild(modal);

            // Load projects
            fetch(`${ API_URL } /api/projects`).then(r => r.json()).then(data => {
                if (data.success) {
                    const select = document.getElementById('service-project-id');
                    select.innerHTML = '<option value="">No Project</option>' +
                        data.data.map(p => `< option value = "${p.id}" > ${ p.name }</option > `).join('');
                }
            });
        }

        async function saveService(event) {
            event.preventDefault();
            const form = document.getElementById('service-form');
            const mode = form.dataset.mode || 'create';
            const serviceId = form.dataset.serviceId;

            const unitPrice = parseFloat(document.getElementById('service-unit-price').value) || 0;
            const quantity = parseFloat(document.getElementById('service-quantity').value) || 1;

            const data = {
                project_id: document.getElementById('service-project-id').value || null,
                name: document.getElementById('service-name').value,
                description: document.getElementById('service-description').value,
                service_type: document.getElementById('service-type').value,
                status: document.getElementById('service-status').value,
                unit_price: unitPrice,
                quantity: quantity,
                notes: document.getElementById('service-notes').value,
            };

            try {
                const url = mode === 'edit' ? `${ API_URL } /api/services / ${ serviceId } ` : `${ API_URL } /api/services`;
                const method = mode === 'edit' ? 'PUT' : 'POST';

                const response = await fetch(url, {
                    method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });

                const result = await response.json();
                if (result.success) {
                    closeModal('service-modal');
                    loadServices();
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                alert('Error saving service: ' + error.message);
            }
        }

        async function editService(id) {
            try {
                const response = await fetch(`${ API_URL } /api/services / ${ id } `);
                const data = await response.json();

                if (data.success) {
                    const svc = data.data;
                    openServiceModal();
                    document.getElementById('service-project-id').value = svc.project_id || '';
                    document.getElementById('service-name').value = svc.name || '';
                    document.getElementById('service-description').value = svc.description || '';
                    document.getElementById('service-type').value = svc.service_type || 'design';
                    document.getElementById('service-status').value = svc.status || 'pending';
                    document.getElementById('service-unit-price').value = svc.unit_price || '';
                    document.getElementById('service-quantity').value = svc.quantity || 1;
                    document.getElementById('service-notes').value = svc.notes || '';
                    document.getElementById('service-form').dataset.mode = 'edit';
                    document.getElementById('service-form').dataset.serviceId = id;
                    document.getElementById('service-modal-title').textContent = 'Edit Service';
                }
            } catch (error) {
                alert('Error loading service: ' + error.message);
            }
        }

        async function deleteService(id) {
            if (!confirm('Delete this service?')) return;
            try {
                const response = await fetch(`${ API_URL } /api/services / ${ id } `, { method: 'DELETE' });
                const data = await response.json();
                if (data.success) {
                    loadServices();
                }
            } catch (error) {
                alert('Error deleting service');
            }
        }

        function addNewService() {
            openServiceModal();
        }

        // ===== CONTACTS MANAGEMENT =====
        async function loadContacts() {
            try {
                const response = await fetch(`${ API_URL } /api/contacts`);
                const data = await response.json();

                if (data.success) {
                    window.allContacts = data.data || [];
                    renderContactsTable(window.allContacts);

                    // Load clients for filter
                    const clientsRes = await fetch(`${ API_URL } /api/clients`);
                    const clientsData = await clientsRes.json();
                    const filterSelect = document.getElementById('contact-filter-client');
                    if (filterSelect && clientsData.data) {
                        filterSelect.innerHTML = '<option value="">All Clients</option>' +
                            clientsData.data.map(c => `< option value = "${c.id}" > ${ c.name }</option > `).join('');
                    }
                }
            } catch (error) {
                console.error('Error loading contacts:', error);
            }
        }

        function renderContactsTable(contacts) {
            const tbody = document.getElementById('contacts-table-body');
            if (contacts.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 2rem;">No contacts yet. Add your first contact!</td></tr>';
            } else {
                tbody.innerHTML = contacts.map(contact => `
            < tr >
                        <td><strong>${contact.first_name || ''} ${contact.last_name || ''}</strong></td>
                        <td>${contact.email || 'â€”'}</td>
                        <td>${contact.phone || 'â€”'}</td>
                        <td>${contact.title || 'â€”'}</td>
                        <td>${contact.role || 'â€”'}</td>
                        <td>
                            <button class="btn btn-secondary btn-small" onclick="editContact('${contact.id}')">Edit</button>
                            <button class="btn btn-secondary btn-small" onclick="deleteContact('${contact.id}')">Delete</button>
                        </td>
                    </tr >
            `).join('');
            }
        }

        function filterContacts() {
            const clientFilter = document.getElementById('contact-filter-client').value;
            let filtered = (window.allContacts || []);

            if (clientFilter) {
                filtered = filtered.filter(c => c.client_id === clientFilter);
            }

            renderContactsTable(filtered);
        }

        function openContactModal(contactId = null) {
            if (!document.getElementById('contact-modal')) {
                createContactModal();
            }
            const modal = document.getElementById('contact-modal');
            modal.classList.add('open');

            if (contactId) {
                loadContactData(contactId);
            } else {
                document.getElementById('contact-form').reset();
                document.getElementById('contact-form').dataset.mode = 'create';
            }
        }

        function createContactModal() {
            const modal = document.createElement('div');
            modal.id = 'contact-modal';
            modal.className = 'modal';
            modal.innerHTML = `
            < div class="modal-content" >
                    <div class="modal-header">
                        <h3 id="contact-modal-title">Add Contact</h3>
                        <button class="modal-close" onclick="closeModal('contact-modal')">&times;</button>
                    </div>
                    <form id="contact-form" onsubmit="saveContact(event)">
                        <div class="form-group">
                            <label>Client</label>
                            <select id="contact-client-id">
                                <option value="">No Client</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>First Name *</label>
                                <input type="text" id="contact-first-name" required>
                            </div>
                            <div class="form-group">
                                <label>Last Name *</label>
                                <input type="text" id="contact-last-name" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="contact-email">
                            </div>
                            <div class="form-group">
                                <label>Phone</label>
                                <input type="tel" id="contact-phone">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Title</label>
                                <input type="text" id="contact-title">
                            </div>
                            <div class="form-group">
                                <label>Role</label>
                                <select id="contact-role">
                                    <option value="primary">Primary</option>
                                    <option value="secondary">Secondary</option>
                                    <option value="billing">Billing</option>
                                    <option value="technical">Technical</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Notes</label>
                            <textarea id="contact-notes" rows="3"></textarea>
                        </div>
                        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                            <button type="submit" class="btn btn-primary">Save Contact</button>
                            <button type="button" class="btn btn-secondary" onclick="closeModal('contact-modal')">Cancel</button>
                        </div>
                    </form>
                </div >
            `;
            document.body.appendChild(modal);

            // Load clients
            fetch(`${ API_URL } /api/clients`).then(r => r.json()).then(data => {
                if (data.success) {
                    const select = document.getElementById('contact-client-id');
                    select.innerHTML = '<option value="">No Client</option>' +
                        data.data.map(c => `< option value = "${c.id}" > ${ c.name }</option > `).join('');
                }
            });
        }

        async function saveContact(event) {
            event.preventDefault();
            const form = document.getElementById('contact-form');
            const mode = form.dataset.mode || 'create';
            const contactId = form.dataset.contactId;

            const data = {
                client_id: document.getElementById('contact-client-id').value || null,
                first_name: document.getElementById('contact-first-name').value,
                last_name: document.getElementById('contact-last-name').value,
                email: document.getElementById('contact-email').value,
                phone: document.getElementById('contact-phone').value,
                title: document.getElementById('contact-title').value,
                role: document.getElementById('contact-role').value,
                notes: document.getElementById('contact-notes').value,
            };

            try {
                const url = mode === 'edit' ? `${ API_URL } /api/contacts / ${ contactId } ` : `${ API_URL } /api/contacts`;
                const method = mode === 'edit' ? 'PUT' : 'POST';

                const response = await fetch(url, {
                    method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });

                const result = await response.json();
                if (result.success) {
                    closeModal('contact-modal');
                    loadContacts();
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                alert('Error saving contact: ' + error.message);
            }
        }

        async function editContact(id) {
            try {
                const response = await fetch(`${ API_URL } /api/contacts / ${ id } `);
                const data = await response.json();

                if (data.success) {
                    const contact = data.data;
                    openContactModal();
                    document.getElementById('contact-client-id').value = contact.client_id || '';
                    document.getElementById('contact-first-name').value = contact.first_name || '';
                    document.getElementById('contact-last-name').value = contact.last_name || '';
                    document.getElementById('contact-email').value = contact.email || '';
                    document.getElementById('contact-phone').value = contact.phone || '';
                    document.getElementById('contact-title').value = contact.title || '';
                    document.getElementById('contact-role').value = contact.role || 'primary';
                    document.getElementById('contact-notes').value = contact.notes || '';
                    document.getElementById('contact-form').dataset.mode = 'edit';
                    document.getElementById('contact-form').dataset.contactId = id;
                    document.getElementById('contact-modal-title').textContent = 'Edit Contact';
                }
            } catch (error) {
                alert('Error loading contact: ' + error.message);
            }
        }

        async function deleteContact(id) {
            if (!confirm('Delete this contact?')) return;
            try {
                const response = await fetch(`${ API_URL } /api/contacts / ${ id } `, { method: 'DELETE' });
                const data = await response.json();
                if (data.success) {
                    loadContacts();
                }
            } catch (error) {
                alert('Error deleting contact');
            }
        }

        function addNewContact() {
            openContactModal();
        }

        // ===== ANALYTICS =====
        async function loadAnalytics() {
            try {
                const [projects, services, clients] = await Promise.all([
                    fetch(`${ API_URL } /api/projects`).then(r => r.json()),
                    fetch(`${ API_URL } /api/services`).then(r => r.json()),
                    fetch(`${ API_URL } /api/clients`).then(r => r.json())
                ]);

                // Calculate revenue
                const totalRevenue = (services.data || []).reduce((sum, s) => sum + (s.total_price || 0), 0);
                document.getElementById('analytics-revenue').textContent = 'Â¥' + totalRevenue.toLocaleString();

                // Active projects
                const activeProjects = (projects.data || []).filter(p => p.status === 'in_progress' || p.status === 'planning').length;
                document.getElementById('analytics-active-projects').textContent = activeProjects;

                // Client growth (this month)
                const thisMonth = new Date();
                thisMonth.setDate(1);
                const thisMonthClients = (clients.data || []).filter(c => c.created_at * 1000 >= thisMonth.getTime()).length;
                const lastMonthClients = (clients.data || []).filter(c => {
                    const lastMonth = new Date(thisMonth);
                    lastMonth.setMonth(lastMonth.getMonth() - 1);
                    return c.created_at * 1000 >= lastMonth.getTime() && c.created_at * 1000 < thisMonth.getTime();
                }).length;
                const growth = lastMonthClients > 0 ? ((thisMonthClients - lastMonthClients) / lastMonthClients * 100).toFixed(1) : (thisMonthClients > 0 ? '100' : '0');
                document.getElementById('analytics-client-growth').textContent = growth + '%';

                // Project status chart
                const statusCounts = {};
                (projects.data || []).forEach(p => {
                    statusCounts[p.status] = (statusCounts[p.status] || 0) + 1;
                });

                const chartContainer = document.getElementById('project-status-chart');
                chartContainer.innerHTML = Object.keys(statusCounts).map(status => `
            < div style = "margin-bottom: 1rem;" >
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span style="text-transform: capitalize;">${status.replace('_', ' ')}</span>
                            <span><strong>${statusCounts[status]}</strong></span>
                        </div>
                        <div style="background: color-mix(in srgb, var(--orange-primary) 10%, transparent); height: 24px; border-radius: 12px; overflow: hidden;">
                            <div style="background: var(--orange-primary); height: 100%; width: ${(statusCounts[status] / (projects.data?.length || 1)) * 100}%; transition: width 0.5s;"></div>
                        </div>
                    </div >
            `).join('');
            } catch (error) {
                console.error('Error loading analytics:', error);
            }
        }

        // ===== EXPORT DATA =====
        async function exportData() {
            try {
                const [clients, properties, projects, services, contacts] = await Promise.all([
                    fetch(`${ API_URL } /api/clients`).then(r => r.json()),
                    fetch(`${ API_URL } /api/properties`).then(r => r.json()),
                    fetch(`${ API_URL } /api/projects`).then(r => r.json()),
                    fetch(`${ API_URL } /api/services`).then(r => r.json()),
                    fetch(`${ API_URL } /api/contacts`).then(r => r.json())
                ]);

                const exportData = {
                    export_date: new Date().toISOString(),
                    clients: clients.data || [],
                    properties: properties.data || [],
                    projects: projects.data || [],
                    services: services.data || [],
                    contacts: contacts.data || []
                };

                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `shinshu - solutions -export -${ new Date().toISOString().split('T')[0] }.json`;
                a.click();
                URL.revokeObjectURL(url);
            } catch (error) {
                alert('Error exporting data: ' + error.message);
            }
        }

        // ===== MODAL HELPERS =====
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('open');
            }
        }

        // Close modal on outside click
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('open');
            }
        });

        // ===== SETTINGS PAGE =====
        function loadSettings() {
            if (window.themes && window.getCurrentTheme) {
                const currentTheme = window.getCurrentTheme();
                const grid = document.getElementById('themes-grid');

                if (grid) {
                    grid.innerHTML = Object.keys(window.themes).map(themeId => {
                        const theme = window.themes[themeId];
                        const isActive = themeId === currentTheme;
                        return `
            < div class="theme-card ${isActive ? 'active' : ''}" onclick = "selectThemeFromSettings('${themeId}')" >
                                <div class="theme-preview-large" style="background: linear-gradient(135deg, ${theme.colors.primary} 0%, ${theme.colors.primaryDark} 100%);">
                                    ${theme.name.charAt(0)}
                                </div>
                                <h3>${theme.name}</h3>
                                <p>${theme.description}</p>
                            </div >
            `;
                    }).join('');
                }
            }
        }

        function selectThemeFromSettings(themeId) {
            if (window.selectTheme) {
                window.selectTheme(themeId);
                loadSettings(); // Reload to update active state
            }
        }

        // ===== CONTENT EDITOR =====
        let currentContentId = null;

        async function loadContentEditor() {
            await loadAllContent();
        }

        async function loadAllContent() {
            try {
                const response = await fetch(`${ API_URL } /api/content`);
                const data = await response.json();

                if (data.success) {
                    const list = document.getElementById('content-items-list');
                    if (data.data.length === 0) {
                        list.innerHTML = '<p>No content yet. Create your first content item!</p>';
                    } else {
                        list.innerHTML = data.data.map(item => `
            < div style = "padding: 1rem; background: white; border-radius: 8px; margin-bottom: 0.5rem; border: 1px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);" >
                <div style="display: flex; justify-content: space-between; align-items: start;">
                    <div>
                        <strong>${item.title || 'Untitled'}</strong>
                        <div style="font-size: 0.85rem; color: var(--text-gray); margin-top: 0.25rem;">
                            ${item.content_type} â€¢ ${item.page_path || item.section_id || 'N/A'} â€¢ ${item.language_code}
                            ${item.is_published ? '<span style="color: #2E7D32; margin-left: 0.5rem;">â— Published</span>' : '<span style="color: #999; margin-left: 0.5rem;">â—‹ Draft</span>'}
                        </div>
                    </div>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="btn btn-secondary btn-small" onclick="editContentItem('${item.id}')">Edit</button>
                        <button class="btn btn-secondary btn-small" onclick="deleteContentItem('${item.id}')">Delete</button>
                    </div>
                </div>
                            </div >
            `).join('');
                    }
                }
            } catch (error) {
                console.error('Error loading content:', error);
            }
        }

        async function loadContent() {
            const selector = document.getElementById('content-selector');
            const value = selector.value;
            if (!value) {
                document.getElementById('content-editor-form').style.display = 'none';
                return;
            }

            // Handle new adventure creation
            if (value === 'adventure:new') {
                document.getElementById('content-editor-form').style.display = 'block';
                document.getElementById('content-title').value = '';
                document.getElementById('content-body').value = '';
                document.getElementById('content-language').value = 'en';
                document.getElementById('content-order').value = '0';
                document.getElementById('content-published').checked = true;
                window.currentContentId = null;

                // Set metadata for adventure type
                const form = document.getElementById('content-editor-form');
                form.dataset.contentType = 'adventure';
                form.dataset.pagePath = '/adventures';
                form.dataset.sectionId = '';
                return;
            }

            const [type, path] = value.split(':');
            let contentType = type === 'page' ? 'page' : type === 'section' ? 'section' : 'component';
            let pagePath = type === 'page' ? path : null;
            let sectionId = type === 'section' ? path : null;

            // Handle adventure content type
            if (type === 'adventure') {
                contentType = 'adventure';
                pagePath = '/adventures';
                sectionId = null;
            }

            try {
                // Try to load existing content
                const response = await fetch(`${ API_URL } /api/content ? type = ${ contentType }& page_path=${ pagePath || '' }& section_id=${ sectionId || '' } `);
                const data = await response.json();

                if (data.success && data.data && data.data.length > 0) {
                    const item = data.data[0];
                    currentContentId = item.id;
                    document.getElementById('content-title').value = item.title || '';
                    document.getElementById('content-body').value = item.content || '';
                    document.getElementById('content-language').value = item.language_code || 'en';
                    document.getElementById('content-order').value = item.order_index || 0;
                    document.getElementById('content-published').checked = item.is_published === 1;
                    
                    // Load SEO metadata
                    const metadata = typeof item.metadata === 'string' ? JSON.parse(item.metadata || '{}') : (item.metadata || {});
                    document.getElementById('content-meta-description').value = metadata.meta_description || '';
                    document.getElementById('content-meta-keywords').value = metadata.meta_keywords || '';
                    document.getElementById('content-og-title').value = metadata.og_title || '';
                    document.getElementById('content-og-description').value = metadata.og_description || '';
                } else {
                    // New content
                    currentContentId = null;
                    document.getElementById('content-title').value = '';
                    document.getElementById('content-body').value = '';
                    document.getElementById('content-language').value = 'en';
                    document.getElementById('content-order').value = 0;
                    document.getElementById('content-published').checked = true;
                }

                // Store metadata
                document.getElementById('content-editor-form').dataset.contentType = contentType;
                document.getElementById('content-editor-form').dataset.pagePath = pagePath || '';
                document.getElementById('content-editor-form').dataset.sectionId = sectionId || '';

                document.getElementById('content-editor-form').style.display = 'block';
            } catch (error) {
                console.error('Error loading content:', error);
                alert('Error loading content');
            }
        }

        async function saveContent() {
            const form = document.getElementById('content-editor-form');
            let contentType = form.dataset.contentType;
            let pagePath = form.dataset.pagePath || null;
            let sectionId = form.dataset.sectionId || null;

            // Handle adventure content type from selector
            const selector = document.getElementById('content-selector');
            if (selector.value === 'adventure:new' || selector.value.startsWith('adventure:')) {
                contentType = 'adventure';
                pagePath = '/adventures';
                sectionId = null;
            }

            const contentData = {
                content_type: contentType,
                page_path: pagePath,
                section_id: sectionId,
                title: document.getElementById('content-title').value,
                content: document.getElementById('content-body').value,
                language_code: document.getElementById('content-language').value,
                order_index: parseInt(document.getElementById('content-order').value) || 0,
                is_published: document.getElementById('content-published').checked ? 1 : 0,
                metadata: JSON.stringify({
                    meta_description: document.getElementById('content-meta-description').value || '',
                    meta_keywords: document.getElementById('content-meta-keywords').value || '',
                    og_title: document.getElementById('content-og-title').value || '',
                    og_description: document.getElementById('content-og-description').value || '',
                }),
            };

            try {
                const url = currentContentId
                    ? `${ API_URL } /api/content / ${ currentContentId } `
                    : `${ API_URL } /api/content`;
                const method = currentContentId ? 'PUT' : 'POST';

                const response = await fetch(url, {
                    method: method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(contentData),
                });

                const data = await response.json();
                if (data.success) {
                    alert('âœ… Content saved! Changes are live on your site immediately.');
                    loadAllContent();
                    loadContent(); // Reload current content
                } else {
                    alert('Error: ' + (data.error || 'Failed to save'));
                }
            } catch (error) {
                alert('Error saving content: ' + error.message);
            }
        }

        function cancelContentEdit() {
            document.getElementById('content-selector').value = '';
            document.getElementById('content-editor-form').style.display = 'none';
            currentContentId = null;
        }

        function previewContent() {
            const content = document.getElementById('content-body').value;
            const preview = document.getElementById('content-preview');
            preview.innerHTML = content;
            preview.style.display = preview.style.display === 'none' ? 'block' : 'none';
        }

        async function insertImageFromAssets() {
            try {
                const response = await fetch(`${ API_URL } /api/assets ? type = image & limit=50`);
                const data = await response.json();
                
                if (data.success && data.data && data.data.length > 0) {
                    const images = data.data.filter(a => a.r2_key);
                    if (images.length === 0) {
                        alert('No images uploaded yet. Upload images in the Assets section first.');
                        return;
                    }
                    
                    const imageList = images.map(img => 
                        `< option value = "${img.id}" > ${ img.title } (${ img.r2_key.split('/').pop() })</option > `
                    ).join('');
                    
                    const select = document.createElement('select');
                    select.innerHTML = '<option value="">-- Select Image --</option>' + imageList;
                    select.style.width = '100%';
                    select.style.padding = '0.5rem';
                    select.style.marginBottom = '0.5rem';
                    
                    const altInput = document.createElement('input');
                    altInput.type = 'text';
                    altInput.placeholder = 'Alt text (optional)';
                    altInput.style.width = '100%';
                    altInput.style.padding = '0.5rem';
                    altInput.style.marginBottom = '0.5rem';
                    
                    const container = document.createElement('div');
                    container.style.padding = '1rem';
                    container.style.background = 'white';
                    container.style.borderRadius = '8px';
                    container.style.border = '2px solid var(--orange-primary)';
                    container.appendChild(select);
                    container.appendChild(altInput);
                    
                    const insertBtn = document.createElement('button');
                    insertBtn.textContent = 'Insert';
                    insertBtn.className = 'btn btn-primary';
                    insertBtn.onclick = () => {
                        const selectedId = select.value;
                        if (!selectedId) {
                            alert('Please select an image');
                            return;
                        }
                        const selectedImg = images.find(img => img.id === selectedId);
                        const imageUrl = `${ API_URL } /api/assets / ${ selectedId }/view`;
        const altText = altInput.value || selectedImg.alt_text || selectedImg.title;

        const textarea = document.getElementById('content-body');
        const cursorPos = textarea.selectionStart;
        const textBefore = textarea.value.substring(0, cursorPos);
        const textAfter = textarea.value.substring(cursorPos);
        textarea.value = textBefore + `<img src="${imageUrl}" alt="${altText}">` + textAfter;
        textarea.focus();

        document.body.removeChild(container);
                    };
        container.appendChild(insertBtn);

        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'btn btn-secondary';
        cancelBtn.style.marginLeft = '0.5rem';
        cancelBtn.onclick = () => document.body.removeChild(container);
        container.appendChild(cancelBtn);

        document.body.appendChild(container);
                } else {
            alert('No images found. Upload images in the Assets section first.');
        }
            } catch (error) {
            alert('Error loading images: ' + error.message);
        }
        }

        function insertImage() {
            const url = prompt('Enter image URL:');
            if (url) {
                const textarea = document.getElementById('content-body');
                const cursorPos = textarea.selectionStart;
                const textBefore = textarea.value.substring(0, cursorPos);
                const textAfter = textarea.value.substring(cursorPos);
                textarea.value = textBefore + `<img src="${url}" alt="">` + textAfter;
                textarea.focus();
                textarea.setSelectionRange(cursorPos + url.length + 15, cursorPos + url.length + 20);
            }
        }

        function insertLink() {
            const url = prompt('Enter URL:');
            const text = prompt('Enter link text:', url);
            if (url && text) {
                const textarea = document.getElementById('content-body');
                const cursorPos = textarea.selectionStart;
                const textBefore = textarea.value.substring(0, cursorPos);
                const textAfter = textarea.value.substring(cursorPos);
                textarea.value = textBefore + `<a href="${url}">${text}</a>` + textAfter;
                textarea.focus();
            }
        }

        async function editContentItem(id) {
            try {
                const response = await fetch(`${API_URL}/api/content/${id}`);
                const data = await response.json();

                if (data.success) {
                    const item = data.data;
                    const selector = document.getElementById('content-selector');
                    let selectorValue = '';

                    if (item.content_type === 'page') {
                        selectorValue = `page:${item.page_path}`;
                    } else if (item.content_type === 'section') {
                        selectorValue = `section:${item.section_id}`;
                    } else {
                        selectorValue = `component:${item.section_id || item.page_path}`;
                    }

                    selector.value = selectorValue;
                    loadContent();
                }
            } catch (error) {
                alert('Error loading content: ' + error.message);
            }
        }

        async function deleteContentItem(id) {
            if (!confirm('Delete this content? This cannot be undone.')) return;

            try {
                const response = await fetch(`${API_URL}/api/content/${id}`, { method: 'DELETE' });
                const data = await response.json();

                if (data.success) {
                    alert('Content deleted');
                    loadAllContent();
                } else {
                    alert('Error: ' + (data.error || 'Failed to delete'));
                }
            } catch (error) {
                alert('Error deleting content: ' + error.message);
            }
        }

        function viewContentHistory() {
            if (!currentContentId) {
                alert('Please select content first');
                return;
            }
            alert('Content history feature coming soon!');
        }

        // Track current content
        window.currentContentId = 'overview';

        // ===== PROJECT SUMMARY EMAIL =====
        async function sendProjectSummaryEmail() {
            if (!confirm('Send professional project summary email to Jake and Sam? This will use your Resend integration.')) {
                return;
            }

            try {
                const response = await fetch(`${API_URL}/api/send-project-summary`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                });

                const data = await response.json();

                if (data.success) {
                    alert(`âœ… ${data.message}\n\nEmail sent to:\nâ€¢ jawaalk@gmail.com (Jake)\nâ€¢ inneranimalclothing@gmail.com (Sam)`);
                } else {
                    if (data.error && data.error.includes('Resend API key not configured')) {
                        alert(`âš ï¸ ${data.error}\n\nPlease set up Resend integration first:\n1. Go to Dashboard â†’ Setup & Integrations\n2. Follow the Resend setup guide\n3. Add your API key to Cloudflare Worker environment variables`);
                    } else {
                        alert(`âŒ Error: ${data.error || 'Failed to send email'}\n\n${data.details ? data.details.join('\n') : ''}`);
                    }
                }
            } catch (error) {
                alert('Error sending project summary: ' + error.message);
            }
        }

        async function sendOnboardingEmails() {
            if (!confirm('Send onboarding emails?\n\nâ€¢ Jake: Step-by-step setup guide\nâ€¢ Sam: Developer overview with cost & time summary\n\nThis will use your Resend integration.')) {
                return;
            }

            try {
                const response = await fetch(`${API_URL}/api/send-onboarding-emails`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                });

                const data = await response.json();

                if (data.success) {
                    const details = data.details || {};
                    let message = `âœ… ${data.message}\n\n`;
                    message += `â€¢ Jake's onboarding: ${details.jake === 'sent' ? 'âœ… Sent' : 'âŒ Failed'}\n`;
                    message += `â€¢ Sam's dev overview: ${details.sam === 'sent' ? 'âœ… Sent' : 'âŒ Failed'}`;
                    alert(message);
                } else {
                    if (data.error && data.error.includes('Resend API key not configured')) {
                        alert(`âš ï¸ ${data.error}\n\nPlease set up Resend integration first:\n1. Go to Dashboard â†’ Setup & Integrations\n2. Follow the Resend setup guide\n3. Add your API key to Cloudflare Worker environment variables`);
                    } else {
                        alert(`âŒ Error: ${data.error || 'Failed to send emails'}\n\n${data.details ? data.details.join('\n') : ''}`);
                    }
                }
            } catch (error) {
                alert('Error sending onboarding emails: ' + error.message);
            }
        }

        // Load initial data
        loadOverview();

        // ===== SETUP & INTEGRATIONS =====
        async function loadSetup() {
            // Status will be shown in the HTML
        }

        async function testResendConnection() {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'Testing...';
            btn.disabled = true;

            try {
                // Try to send a test email via the API
                const response = await fetch(`${API_URL}/api/test-resend`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                });

                const data = await response.json();

                if (data.success) {
                    const resendStatus = document.getElementById('resend-status');
                    if (resendStatus) {
                        resendStatus.innerHTML = `
                            <p style="margin: 0; font-weight: 600; color: #2e7d32;">âœ… Resend Configured & Working!</p>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; color: var(--text-gray);">${data.message || 'Test email sent successfully. Resend is ready to use.'}</p>
                        `;
                        resendStatus.style.background = '#e8f5e9';
                        resendStatus.style.borderLeftColor = '#4caf50';
                    }
                    alert('âœ… Resend connection successful! Test email sent.');
                } else {
                    if (data.error && data.error.includes('not configured')) {
                        alert('âš ï¸ Resend API key not found in Cloudflare Worker.\n\nPlease:\n1. Add RESEND_API_KEY to Cloudflare Worker environment variables\n2. Redeploy the worker\n3. Try again');
                    } else {
                        alert('âŒ Error: ' + (data.error || 'Failed to test connection'));
                    }
                }
            } catch (error) {
                alert('âŒ Error testing Resend: ' + error.message + '\n\nMake sure you\'ve added the API key to Cloudflare Worker environment variables and redeployed.');
            } finally {
                btn.textContent = originalText;
                btn.disabled = false;
            }
        }

        // ===== CUSTOMER SERVICE =====
        let allInquiries = [];
        let currentInquiryFilter = 'all';
        let currentLanguageFilter = '';

        async function loadCustomerService() {
            await loadInquiries();
            calculateServiceStats();
        }

        async function loadInquiries() {
            try {
                const response = await fetch(`${API_URL}/api/inquiries`);
                const data = await response.json();

                if (data.success) {
                    allInquiries = data.data || [];
                    // Update both inquiries list and customer service table if they exist
                    renderInquiriesTable();
                    if (document.getElementById('customer-service-table-body')) {
                        renderInquiriesTable();
                    }
                    // Also update the inquiries list view
                    if (document.getElementById('inquiries-list')) {
                        renderInquiriesList();
                    }
                }
            } catch (error) {
                console.error('Error loading inquiries:', error);
                if (document.getElementById('customer-service-table-body')) {
                    document.getElementById('customer-service-table-body').innerHTML =
                        '<tr><td colspan="7" style="text-align: center; padding: 2rem; color: #d32f2f;">Error loading inquiries</td></tr>';
                }
            }
        }

        function renderInquiriesList() {
            const list = document.getElementById('inquiries-list');
            if (!list) return;

            if (allInquiries.length === 0) {
                list.innerHTML = '<p>No inquiries yet.</p>';
                return;
            }

            list.innerHTML = allInquiries.map(inquiry => `
                <div style="padding: 1rem; background: white; border-radius: 8px; margin-bottom: 0.5rem; border: 1px solid color-mix(in srgb, var(--orange-primary) 20%, transparent);">
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div>
                            <strong>${inquiry.name}</strong> (${inquiry.email})
                            <div style="font-size: 0.85rem; color: var(--text-gray); margin-top: 0.25rem;">
                                ${inquiry.subject || 'No subject'} â€¢ ${inquiry.language_code.toUpperCase()} â€¢ ${new Date(inquiry.created_at * 1000).toLocaleDateString()}
                                <span style="margin-left: 0.5rem; padding: 0.25rem 0.5rem; background: ${inquiry.status === 'new' ? '#ff9800' : inquiry.status === 'responded' ? '#2196f3' : '#4caf50'}20; border-radius: 4px; color: ${inquiry.status === 'new' ? '#ff9800' : inquiry.status === 'responded' ? '#2196f3' : '#4caf50'};">
                                    ${inquiry.status}
                                </span>
                            </div>
                            <p style="margin-top: 0.5rem; font-size: 0.9rem;">${inquiry.message.substring(0, 150)}${inquiry.message.length > 150 ? '...' : ''}</p>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn btn-secondary btn-small" onclick="viewInquiry('${inquiry.id}')">View</button>
                            <button class="btn btn-secondary btn-small" onclick="updateInquiryStatus('${inquiry.id}', 'responded')">Respond</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderInquiriesTable() {
            const tbody = document.getElementById('customer-service-table-body');
            if (!tbody || !allInquiries) return;

            let filtered = allInquiries;

            // Filter by status
            if (currentInquiryFilter !== 'all') {
                filtered = filtered.filter(i => i.status === currentInquiryFilter);
            }

            // Filter by language
            if (currentLanguageFilter) {
                filtered = filtered.filter(i => i.language_code === currentLanguageFilter);
            }

            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 2rem;">No inquiries found</td></tr>';
                return;
            }

            tbody.innerHTML = filtered.map(inquiry => {
                const date = new Date(inquiry.created_at * 1000).toLocaleDateString();
                const languageFlags = {
                    'en': 'ðŸ‡ºðŸ‡¸',
                    'ja': 'ðŸ‡¯ðŸ‡µ',
                    'zh': 'ðŸ‡¨ðŸ‡³',
                    'ko': 'ðŸ‡°ðŸ‡·'
                };
                const statusColors = {
                    'new': '#ff9800',
                    'responded': '#2196f3',
                    'resolved': '#4caf50',
                    'archived': '#999'
                };

                return `
                    <tr>
                        <td>${date}</td>
                        <td><strong>${inquiry.name}</strong></td>
                        <td>${inquiry.email}</td>
                        <td>${languageFlags[inquiry.language_code] || 'ðŸŒ'} ${inquiry.language_code.toUpperCase()}</td>
                        <td>${inquiry.subject || 'No subject'}</td>
                        <td>
                            <span style="padding: 0.25rem 0.75rem; border-radius: 12px; background: ${statusColors[inquiry.status] || '#999'}20; color: ${statusColors[inquiry.status] || '#999'}; font-size: 0.85rem; font-weight: 600;">
                                ${inquiry.status.charAt(0).toUpperCase() + inquiry.status.slice(1)}
                            </span>
                        </td>
                        <td>
                            <button class="btn btn-secondary btn-small" onclick="viewInquiry('${inquiry.id}')">View</button>
                            <button class="btn btn-secondary btn-small" onclick="updateInquiryStatus('${inquiry.id}', 'responded')">Mark Responded</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function filterInquiriesByStatus(status) {
            currentInquiryFilter = status;
            document.querySelectorAll('#customer-service-content .btn').forEach(btn => {
                btn.classList.remove('btn-primary');
                btn.classList.add('btn-secondary');
            });
            event.target.classList.remove('btn-secondary');
            event.target.classList.add('btn-primary');
            renderInquiriesTable();
        }

        function filterInquiriesByLanguage() {
            currentLanguageFilter = document.getElementById('inquiry-language-filter').value;
            renderInquiriesTable();
        }

        async function viewInquiry(id) {
            try {
                const response = await fetch(`${API_URL}/api/inquiries/${id}`);
                const data = await response.json();

                if (data.success) {
                    const inquiry = data.data;
                    const languageNames = {
                        'en': 'English',
                        'ja': 'Japanese (æ—¥æœ¬èªž)',
                        'zh': 'Chinese (ä¸­æ–‡)',
                        'ko': 'Korean (í•œêµ­ì–´)'
                    };

                    alert(`Inquiry Details:\n\nName: ${inquiry.name}\nEmail: ${inquiry.email}\nPhone: ${inquiry.phone || 'N/A'}\nLanguage: ${languageNames[inquiry.language_code] || inquiry.language_code}\nSubject: ${inquiry.subject || 'No subject'}\n\nMessage:\n${inquiry.message}\n\nStatus: ${inquiry.status}\nCreated: ${new Date(inquiry.created_at * 1000).toLocaleString()}`);
                }
            } catch (error) {
                alert('Error loading inquiry: ' + error.message);
            }
        }

        async function updateInquiryStatus(id, status) {
            try {
                const response = await fetch(`${API_URL}/api/inquiries/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ status })
                });

                const data = await response.json();
                if (data.success) {
                    await loadInquiries();
                    calculateServiceStats();
                }
            } catch (error) {
                alert('Error updating status: ' + error.message);
            }
        }

        function calculateServiceStats() {
            const total = allInquiries.length;
            document.getElementById('cs-total-inquiries').textContent = total;

            // Calculate average response time (simplified)
            const responded = allInquiries.filter(i => i.status === 'responded' || i.status === 'resolved');
            if (responded.length > 0) {
                // This would need actual response time tracking
                document.getElementById('cs-avg-response-time').textContent = '< 24h';
            }
        }
    </script>
</body>

</html>